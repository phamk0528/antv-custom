{"code":"import { __assign, __extends, __values } from \"tslib\";\r\nimport { get, isBoolean, last, maxBy, set } from 'lodash';\r\nimport { TableColHeader } from \"./header/table-col\";\r\nimport { getOccupiedWidthForTableCol } from \"../utils/cell/table-col-cell\";\r\nimport { getValidFrozenOptions } from \"../utils/layout/frozen\";\r\nimport { getIndexRangeWithOffsets } from \"../utils/facet\";\r\nimport { calculateFrozenCornerCells, calculateInViewIndexes, getFrozenDataCellType, splitInViewIndexesWithFrozen, translateGroup, translateGroupX, translateGroupY, isFrozenTrailingCol, isFrozenTrailingRow, } from './utils';\r\nimport { CornerBBox } from './bbox/cornerBBox';\r\nimport { TableRowCell } from \"../cell\";\r\nimport { getDataCellId } from \"../utils/cell/data-cell\";\r\nimport { KEY_GROUP_ROW_RESIZE_AREA, LayoutWidthTypes, S2Event, SERIES_NUMBER_FIELD, FRONT_GROUND_GROUP_COL_FROZEN_Z_INDEX, KEY_GROUP_FROZEN_SPLIT_LINE, KEY_GROUP_FROZEN_ROW_RESIZE_AREA, } from \"../common/constant\";\r\nimport { FrozenCellGroupMap } from \"../common/constant/frozen\";\r\nimport { DebuggerUtil } from \"../common/debug\";\r\nimport { BaseFacet } from \"./base-facet\";\r\nimport { buildHeaderHierarchy } from \"./layout/build-header-hierarchy\";\r\nimport { Hierarchy } from \"./layout/hierarchy\";\r\nimport { layoutCoordinate } from \"./layout/layout-hooks\";\r\nimport { Node } from \"./layout/node\";\r\nimport { renderLine } from \"../utils/g-renders\";\r\nimport { measureTextWidth, measureTextWidthRoughly } from \"../utils/text\";\r\nimport { getAllChildCells } from \"../utils/get-all-child-cells\";\r\nvar TableFacet = /** @class */ (function (_super) {\r\n    __extends(TableFacet, _super);\r\n    function TableFacet(cfg) {\r\n        var _this = _super.call(this, cfg) || this;\r\n        _this.frozenGroupInfo = {\r\n            col: {\r\n                width: 0,\r\n            },\r\n            row: {\r\n                height: 0,\r\n            },\r\n            trailingRow: {\r\n                height: 0,\r\n            },\r\n            trailingCol: {\r\n                width: 0,\r\n            },\r\n        };\r\n        _this.panelScrollGroupIndexes = [];\r\n        _this.initFrozenGroupPosition = function () {\r\n            var _a = _this.getScrollOffset(), scrollY = _a.scrollY, scrollX = _a.scrollX;\r\n            var paginationScrollY = _this.getPaginationScrollY();\r\n            translateGroup(_this.spreadsheet.frozenRowGroup, _this.cornerBBox.width - scrollX, _this.cornerBBox.height - paginationScrollY);\r\n            translateGroup(_this.spreadsheet.frozenColGroup, _this.cornerBBox.width, _this.cornerBBox.height - scrollY - paginationScrollY);\r\n            translateGroup(_this.spreadsheet.frozenTrailingColGroup, _this.cornerBBox.width, _this.cornerBBox.height - scrollY - paginationScrollY);\r\n            translateGroup(_this.spreadsheet.frozenTopGroup, _this.cornerBBox.width, _this.cornerBBox.height - paginationScrollY);\r\n        };\r\n        _this.getTotalHeightForRange = function (start, end) {\r\n            if (start < 0 || end < 0)\r\n                return 0;\r\n            if (_this.rowOffsets) {\r\n                return _this.rowOffsets[end + 1] - _this.rowOffsets[start];\r\n            }\r\n            var totalHeight = 0;\r\n            for (var index = start; index < end + 1; index++) {\r\n                var height = _this.getDefaultCellHeight();\r\n                totalHeight += height;\r\n            }\r\n            return totalHeight;\r\n        };\r\n        _this.getShadowFill = function (angle) {\r\n            var _a, _b;\r\n            var style = get(_this.cfg, 'spreadsheet.theme.splitLine');\r\n            return \"l (\".concat(angle, \") 0:\").concat((_a = style.shadowColors) === null || _a === void 0 ? void 0 : _a.left, \" 1:\").concat((_b = style.shadowColors) === null || _b === void 0 ? void 0 : _b.right);\r\n        };\r\n        _this.renderFrozenGroupSplitLine = function (scrollX, scrollY) {\r\n            var _a;\r\n            var _b = _this.panelBBox, panelWidth = _b.width, panelHeight = _b.height, viewportWidth = _b.viewportWidth, viewportHeight = _b.viewportHeight;\r\n            var cornerHeight = _this.cornerBBox.height;\r\n            var colLeafNodes = _this.layoutResult.colLeafNodes;\r\n            var cellRange = _this.getCellRange();\r\n            var dataLength = cellRange.end - cellRange.start;\r\n            var _c = getValidFrozenOptions(_this.spreadsheet.options, colLeafNodes.length, dataLength), frozenRowCount = _c.frozenRowCount, frozenColCount = _c.frozenColCount, frozenTrailingColCount = _c.frozenTrailingColCount, frozenTrailingRowCount = _c.frozenTrailingRowCount;\r\n            // 在分页条件下需要额外处理 Y 轴滚动值\r\n            var relativeScrollY = Math.floor(scrollY - _this.getPaginationScrollY());\r\n            // scroll boundary\r\n            var maxScrollX = Math.max(0, last(_this.viewCellWidths) - viewportWidth);\r\n            var maxScrollY = Math.max(0, _this.viewCellHeights.getCellOffsetY(cellRange.end + 1) -\r\n                _this.viewCellHeights.getCellOffsetY(cellRange.start) -\r\n                viewportHeight);\r\n            // remove previous splitline group\r\n            (_a = _this.foregroundGroup.findById(KEY_GROUP_FROZEN_SPLIT_LINE)) === null || _a === void 0 ? void 0 : _a.remove();\r\n            var style = get(_this.cfg, 'spreadsheet.theme.splitLine');\r\n            var splitLineGroup = _this.foregroundGroup.addGroup({\r\n                id: KEY_GROUP_FROZEN_SPLIT_LINE,\r\n                zIndex: FRONT_GROUND_GROUP_COL_FROZEN_Z_INDEX,\r\n            });\r\n            var verticalBorderStyle = {\r\n                lineWidth: style === null || style === void 0 ? void 0 : style.verticalBorderWidth,\r\n                stroke: style === null || style === void 0 ? void 0 : style.verticalBorderColor,\r\n                opacity: style === null || style === void 0 ? void 0 : style.verticalBorderColorOpacity,\r\n            };\r\n            var horizontalBorderStyle = {\r\n                lineWidth: style === null || style === void 0 ? void 0 : style.horizontalBorderWidth,\r\n                stroke: style === null || style === void 0 ? void 0 : style.horizontalBorderColor,\r\n                opacity: style === null || style === void 0 ? void 0 : style.horizontalBorderColorOpacity,\r\n            };\r\n            if (frozenColCount > 0) {\r\n                var x = colLeafNodes.reduce(function (prev, item, idx) {\r\n                    if (idx < frozenColCount) {\r\n                        return prev + item.width;\r\n                    }\r\n                    return prev;\r\n                }, 0);\r\n                var height = frozenTrailingRowCount > 0 ? panelHeight : viewportHeight;\r\n                renderLine(splitLineGroup, {\r\n                    x1: x,\r\n                    x2: x,\r\n                    y1: cornerHeight,\r\n                    y2: cornerHeight + height,\r\n                }, __assign({}, verticalBorderStyle));\r\n                if (style.showShadow && scrollX > 0) {\r\n                    splitLineGroup.addShape('rect', {\r\n                        attrs: {\r\n                            x: x,\r\n                            y: cornerHeight,\r\n                            width: style.shadowWidth,\r\n                            height: height,\r\n                            fill: _this.getShadowFill(0),\r\n                        },\r\n                    });\r\n                }\r\n            }\r\n            if (frozenRowCount > 0) {\r\n                var y = cornerHeight +\r\n                    _this.getTotalHeightForRange(cellRange.start, cellRange.start + frozenRowCount - 1);\r\n                var width = frozenTrailingColCount > 0 ? panelWidth : viewportWidth;\r\n                renderLine(splitLineGroup, {\r\n                    x1: 0,\r\n                    x2: width,\r\n                    y1: y,\r\n                    y2: y,\r\n                }, __assign({}, horizontalBorderStyle));\r\n                if (style.showShadow && relativeScrollY > 0) {\r\n                    splitLineGroup.addShape('rect', {\r\n                        attrs: {\r\n                            x: 0,\r\n                            y: y,\r\n                            width: width,\r\n                            height: style.shadowWidth,\r\n                            fill: _this.getShadowFill(90),\r\n                        },\r\n                    });\r\n                }\r\n            }\r\n            if (frozenTrailingColCount > 0) {\r\n                var width = colLeafNodes.reduceRight(function (prev, item, idx) {\r\n                    if (idx >= colLeafNodes.length - frozenTrailingColCount) {\r\n                        return prev + item.width;\r\n                    }\r\n                    return prev;\r\n                }, 0);\r\n                var x = panelWidth - width;\r\n                var height = frozenTrailingRowCount ? panelHeight : viewportHeight;\r\n                renderLine(splitLineGroup, {\r\n                    x1: x,\r\n                    x2: x,\r\n                    y1: cornerHeight,\r\n                    y2: cornerHeight + height,\r\n                }, __assign({}, verticalBorderStyle));\r\n                if (style.showShadow && Math.floor(scrollX) < Math.floor(maxScrollX)) {\r\n                    splitLineGroup.addShape('rect', {\r\n                        attrs: {\r\n                            x: x - style.shadowWidth,\r\n                            y: cornerHeight,\r\n                            width: style.shadowWidth,\r\n                            height: height,\r\n                            fill: _this.getShadowFill(180),\r\n                        },\r\n                    });\r\n                }\r\n            }\r\n            if (frozenTrailingRowCount > 0) {\r\n                var y = _this.panelBBox.maxY -\r\n                    _this.getTotalHeightForRange(cellRange.end - frozenTrailingRowCount + 1, cellRange.end);\r\n                var width = frozenTrailingColCount > 0 ? panelWidth : viewportWidth;\r\n                renderLine(splitLineGroup, {\r\n                    x1: 0,\r\n                    x2: width,\r\n                    y1: y,\r\n                    y2: y,\r\n                }, __assign({}, horizontalBorderStyle));\r\n                if (style.showShadow && relativeScrollY < Math.floor(maxScrollY)) {\r\n                    splitLineGroup.addShape('rect', {\r\n                        attrs: {\r\n                            x: 0,\r\n                            y: y - style.shadowWidth,\r\n                            width: width,\r\n                            height: style.shadowWidth,\r\n                            fill: _this.getShadowFill(270),\r\n                        },\r\n                    });\r\n                }\r\n            }\r\n            _this.foregroundGroup.sort();\r\n        };\r\n        _this.renderFrozenPanelCornerGroup = function () {\r\n            var colLength = _this.layoutResult.colLeafNodes.length;\r\n            var cellRange = _this.getCellRange();\r\n            var _a = getValidFrozenOptions(_this.spreadsheet.options, colLength, cellRange.end - cellRange.start + 1), frozenRowCount = _a.frozenRowCount, frozenColCount = _a.frozenColCount, frozenTrailingRowCount = _a.frozenTrailingRowCount, frozenTrailingColCount = _a.frozenTrailingColCount;\r\n            var result = calculateFrozenCornerCells({\r\n                frozenRowCount: frozenRowCount,\r\n                frozenColCount: frozenColCount,\r\n                frozenTrailingRowCount: frozenTrailingRowCount,\r\n                frozenTrailingColCount: frozenTrailingColCount,\r\n            }, colLength, cellRange);\r\n            Object.keys(result).forEach(function (key) {\r\n                var cells = result[key];\r\n                var group = _this.spreadsheet[FrozenCellGroupMap[key]];\r\n                if (group) {\r\n                    cells.forEach(function (cell) {\r\n                        _this.addFrozenCell(cell.x, cell.y, group);\r\n                    });\r\n                }\r\n            });\r\n        };\r\n        _this.addFrozenCell = function (colIndex, rowIndex, group) {\r\n            var viewMeta = _this.layoutResult.getCellMeta(rowIndex, colIndex);\r\n            if (viewMeta) {\r\n                var cell = _this.cfg.dataCell(viewMeta);\r\n                group.add(cell);\r\n            }\r\n        };\r\n        _this.addCell = function (cell) {\r\n            var _a = _this.spreadsheet.options, frozenRowCount = _a.frozenRowCount, frozenColCount = _a.frozenColCount, frozenTrailingRowCount = _a.frozenTrailingRowCount, frozenTrailingColCount = _a.frozenTrailingColCount;\r\n            var colLength = _this.layoutResult.colsHierarchy.getLeaves().length;\r\n            var cellRange = _this.getCellRange();\r\n            var frozenCellType = getFrozenDataCellType(cell.getMeta(), {\r\n                frozenRowCount: frozenRowCount,\r\n                frozenColCount: frozenColCount,\r\n                frozenTrailingRowCount: frozenTrailingRowCount,\r\n                frozenTrailingColCount: frozenTrailingColCount,\r\n            }, colLength, cellRange);\r\n            var group = FrozenCellGroupMap[frozenCellType];\r\n            if (group) {\r\n                _this.spreadsheet[group].add(cell);\r\n            }\r\n        };\r\n        _this.getFrozenOptions = function () {\r\n            var colLength = _this.layoutResult.colLeafNodes.length;\r\n            var cellRange = _this.getCellRange();\r\n            return getValidFrozenOptions(_this.cfg, colLength, cellRange.end - cellRange.start + 1);\r\n        };\r\n        var s2 = _this.spreadsheet;\r\n        s2.on(S2Event.RANGE_SORT, function (sortParams) {\r\n            var params = sortParams;\r\n            // 兼容之前 sortParams 为对象的用法\r\n            if (!Array.isArray(sortParams)) {\r\n                params = [sortParams];\r\n            }\r\n            set(s2.dataCfg, 'sortParams', params.map(function (item) {\r\n                var _a;\r\n                return (__assign(__assign({}, item), { \r\n                    // 兼容之前 sortKey 的用法\r\n                    sortFieldId: (_a = item.sortKey) !== null && _a !== void 0 ? _a : item.sortFieldId }));\r\n            }));\r\n            s2.setDataCfg(s2.dataCfg);\r\n            s2.render(true);\r\n            s2.emit(S2Event.RANGE_SORTED, s2.dataSet.getDisplayDataSet());\r\n        });\r\n        s2.on(S2Event.RANGE_FILTER, function (params) {\r\n            /** remove filter params on current key if passed an empty filterValues field */\r\n            var unFilter = !params.filteredValues || params.filteredValues.length === 0;\r\n            var oldConfig = s2.dataCfg.filterParams || [];\r\n            // check whether filter condition already exists on column, if so, modify it instead.\r\n            var oldIndex = oldConfig.findIndex(function (item) { return item.filterKey === params.filterKey; });\r\n            if (oldIndex !== -1) {\r\n                if (unFilter) {\r\n                    // remove filter params on current key if passed an empty filterValues field\r\n                    oldConfig.splice(oldIndex);\r\n                }\r\n                else {\r\n                    // if filter with same key already exists, replace it\r\n                    oldConfig[oldIndex] = params;\r\n                }\r\n            }\r\n            else {\r\n                oldConfig.push(params);\r\n            }\r\n            set(s2.dataCfg, 'filterParams', oldConfig);\r\n            s2.render(true);\r\n            s2.emit(S2Event.RANGE_FILTERED, s2.dataSet.getDisplayDataSet());\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TableFacet.prototype, \"dataCellTheme\", {\r\n        get: function () {\r\n            return this.spreadsheet.theme.dataCell.cell;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    TableFacet.prototype.calculateCornerBBox = function () {\r\n        var colsHierarchy = this.layoutResult.colsHierarchy;\r\n        var height = Math.floor(colsHierarchy.height);\r\n        this.cornerBBox = new CornerBBox(this);\r\n        this.cornerBBox.height = height;\r\n        this.cornerBBox.maxY = height;\r\n    };\r\n    TableFacet.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this.spreadsheet.off(S2Event.RANGE_SORT);\r\n        this.spreadsheet.off(S2Event.RANGE_FILTER);\r\n    };\r\n    TableFacet.prototype.doLayout = function () {\r\n        var _this = this;\r\n        var _a = this.cfg, dataSet = _a.dataSet, spreadsheet = _a.spreadsheet;\r\n        var rowsHierarchy = new Hierarchy();\r\n        var _b = buildHeaderHierarchy({\r\n            isRowHeader: false,\r\n            facetCfg: this.cfg,\r\n        }), colLeafNodes = _b.leafNodes, colsHierarchy = _b.hierarchy;\r\n        this.calculateColNodesCoordinate(colLeafNodes, colsHierarchy);\r\n        var getCellMeta = function (rowIndex, colIndex) {\r\n            var _a;\r\n            var showSeriesNumber = _this.cfg.showSeriesNumber;\r\n            var col = colLeafNodes[colIndex];\r\n            var cellHeight = _this.getCellHeight(rowIndex);\r\n            var cellRange = _this.getCellRange();\r\n            var _b = getValidFrozenOptions(_this.cfg, colLeafNodes.length, cellRange.end - cellRange.start + 1), frozenTrailingColCount = _b.frozenTrailingColCount, frozenTrailingRowCount = _b.frozenTrailingRowCount;\r\n            var data;\r\n            var width = _this.panelBBox.maxX;\r\n            var colLength = colLeafNodes.length;\r\n            var x = col.x;\r\n            var y = _this.viewCellHeights.getCellOffsetY(rowIndex);\r\n            if (isFrozenTrailingRow(rowIndex, cellRange.end, frozenTrailingRowCount)) {\r\n                y =\r\n                    _this.panelBBox.maxY -\r\n                        _this.getTotalHeightForRange(rowIndex, cellRange.end);\r\n            }\r\n            if (isFrozenTrailingCol(colIndex, frozenTrailingColCount, colLength)) {\r\n                x =\r\n                    width -\r\n                        colLeafNodes\r\n                            .slice(-(colLength - colIndex))\r\n                            .reduce(function (prev, item, idx) {\r\n                            return prev + item.width;\r\n                        }, 0);\r\n            }\r\n            if (showSeriesNumber && col.field === SERIES_NUMBER_FIELD) {\r\n                data = rowIndex + 1;\r\n            }\r\n            else {\r\n                data = dataSet.getCellData({\r\n                    query: {\r\n                        col: col.field,\r\n                        rowIndex: rowIndex,\r\n                    },\r\n                });\r\n            }\r\n            return {\r\n                spreadsheet: spreadsheet,\r\n                x: x,\r\n                y: y,\r\n                width: col.width,\r\n                height: cellHeight,\r\n                data: (_a = {},\r\n                    _a[col.field] = data,\r\n                    _a),\r\n                rowIndex: rowIndex,\r\n                colIndex: colIndex,\r\n                isTotals: false,\r\n                colId: col.id,\r\n                rowId: String(rowIndex),\r\n                valueField: col.field,\r\n                fieldValue: data,\r\n                id: getDataCellId(String(rowIndex), col.id),\r\n            };\r\n        };\r\n        var layoutResult = {\r\n            colNodes: colsHierarchy.getNodes(),\r\n            colsHierarchy: colsHierarchy,\r\n            rowNodes: rowsHierarchy.getNodes(),\r\n            rowsHierarchy: rowsHierarchy,\r\n            rowLeafNodes: rowsHierarchy.getLeaves(),\r\n            colLeafNodes: colLeafNodes,\r\n            getCellMeta: getCellMeta,\r\n            spreadsheet: spreadsheet,\r\n        };\r\n        return layoutResult;\r\n    };\r\n    TableFacet.prototype.getAdaptiveColWidth = function (colLeafNodes) {\r\n        var cellCfg = this.cfg.cellCfg;\r\n        var showSeriesNumber = this.cfg.showSeriesNumber;\r\n        if (this.spreadsheet.getLayoutWidthType() !== LayoutWidthTypes.Compact) {\r\n            var seriesNumberWidth = this.getSeriesNumberWidth();\r\n            var colHeaderColSize = colLeafNodes.length - (showSeriesNumber ? 1 : 0);\r\n            var canvasW = this.getCanvasHW().width - seriesNumberWidth;\r\n            return Math.max(cellCfg.width, canvasW / Math.max(1, colHeaderColSize));\r\n        }\r\n        return cellCfg.width;\r\n    };\r\n    TableFacet.prototype.getColNodeHeight = function (col) {\r\n        var colCfg = this.cfg.colCfg;\r\n        // 明细表所有列节点高度保持一致\r\n        var userDragHeight = Object.values(get(colCfg, \"heightByField\"))[0];\r\n        return userDragHeight || colCfg.height;\r\n    };\r\n    TableFacet.prototype.calculateColNodesCoordinate = function (colLeafNodes, colsHierarchy) {\r\n        var e_1, _a;\r\n        var _b;\r\n        var preLeafNode = Node.blankNode();\r\n        var allNodes = colsHierarchy.getNodes();\r\n        try {\r\n            for (var _c = __values(colsHierarchy.sampleNodesForAllLevels), _d = _c.next(); !_d.done; _d = _c.next()) {\r\n                var levelSample = _d.value;\r\n                levelSample.height = this.getColNodeHeight(levelSample);\r\n                colsHierarchy.height += levelSample.height;\r\n            }\r\n        }\r\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n        finally {\r\n            try {\r\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\r\n            }\r\n            finally { if (e_1) throw e_1.error; }\r\n        }\r\n        var frozenTrailingColCount = getValidFrozenOptions((_b = this.spreadsheet) === null || _b === void 0 ? void 0 : _b.options, allNodes.length).frozenTrailingColCount;\r\n        var adaptiveColWitdth = this.getAdaptiveColWidth(colLeafNodes);\r\n        var nodes = [];\r\n        for (var i = 0; i < allNodes.length; i++) {\r\n            var currentNode = allNodes[i];\r\n            currentNode.colIndex = i;\r\n            currentNode.x = preLeafNode.x + preLeafNode.width;\r\n            currentNode.width = this.calculateColLeafNodesWidth(currentNode, adaptiveColWitdth);\r\n            preLeafNode = currentNode;\r\n            currentNode.y = 0;\r\n            currentNode.height = this.getColNodeHeight(currentNode);\r\n            nodes.push(currentNode);\r\n            layoutCoordinate(this.cfg, null, currentNode);\r\n            colsHierarchy.width += currentNode.width;\r\n        }\r\n        preLeafNode = Node.blankNode();\r\n        var canvasW = this.getCanvasHW().width;\r\n        if (frozenTrailingColCount > 0) {\r\n            for (var i = 1; i <= allNodes.length; i++) {\r\n                var currentNode = allNodes[allNodes.length - i];\r\n                if (currentNode.colIndex >=\r\n                    colLeafNodes.length - frozenTrailingColCount) {\r\n                    if (currentNode.colIndex === allNodes.length - 1) {\r\n                        currentNode.x = canvasW - currentNode.width;\r\n                    }\r\n                    else {\r\n                        currentNode.x = preLeafNode.x - currentNode.width;\r\n                    }\r\n                    preLeafNode = currentNode;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TableFacet.prototype.calculateColLeafNodesWidth = function (col, adaptiveColWitdth) {\r\n        var _a;\r\n        var _b = this.cfg, colCfg = _b.colCfg, dataSet = _b.dataSet, spreadsheet = _b.spreadsheet;\r\n        var layoutWidthType = this.spreadsheet.getLayoutWidthType();\r\n        var userDragWidth = get(get(colCfg, 'widthByFieldValue'), \"\".concat(col.value), col.width);\r\n        var colWidth;\r\n        if (userDragWidth) {\r\n            colWidth = userDragWidth;\r\n        }\r\n        else {\r\n            if (layoutWidthType === LayoutWidthTypes.Compact) {\r\n                var datas = dataSet.getDisplayDataSet();\r\n                var colLabel = col.label;\r\n                var allLabels = ((_a = datas === null || datas === void 0 ? void 0 : datas.map(function (data) { return \"\".concat(data[col.key]); })) === null || _a === void 0 ? void 0 : _a.slice(0, 50)) || []; // 采样取了前50\r\n                allLabels.push(colLabel);\r\n                var maxLabel = maxBy(allLabels, function (label) {\r\n                    return measureTextWidthRoughly(label);\r\n                });\r\n                var colCellTextStyle = spreadsheet.theme.colCell.bolderText;\r\n                var _c = spreadsheet.theme.dataCell, dataCellTextStyle = _c.text, cellStyle = _c.cell;\r\n                DebuggerUtil.getInstance().logger('Max Label In Col:', col.field, maxLabel);\r\n                // 最长的 Label 如果是列名，按列名的标准计算宽度\r\n                if (colLabel === maxLabel) {\r\n                    colWidth =\r\n                        measureTextWidth(maxLabel, colCellTextStyle) +\r\n                            getOccupiedWidthForTableCol(this.spreadsheet, col, spreadsheet.theme.colCell);\r\n                }\r\n                else {\r\n                    colWidth =\r\n                        measureTextWidth(maxLabel, dataCellTextStyle) +\r\n                            cellStyle.padding.left +\r\n                            cellStyle.padding.right;\r\n                }\r\n            }\r\n            else {\r\n                colWidth = adaptiveColWitdth;\r\n            }\r\n            if (col.field === SERIES_NUMBER_FIELD) {\r\n                colWidth = this.getSeriesNumberWidth();\r\n            }\r\n        }\r\n        return colWidth;\r\n    };\r\n    TableFacet.prototype.getDefaultCellHeight = function () {\r\n        var _a, _b;\r\n        var cellCfg = this.cfg.cellCfg;\r\n        return (cellCfg.height +\r\n            ((_a = this.dataCellTheme.padding) === null || _a === void 0 ? void 0 : _a.top) +\r\n            ((_b = this.dataCellTheme.padding) === null || _b === void 0 ? void 0 : _b.bottom));\r\n    };\r\n    TableFacet.prototype.getCellHeight = function (index) {\r\n        if (this.rowOffsets) {\r\n            var heightByField = get(this.spreadsheet, 'options.style.rowCfg.heightByField', {});\r\n            var customHeight = heightByField[String(index)];\r\n            if (customHeight) {\r\n                return customHeight;\r\n            }\r\n        }\r\n        return this.getDefaultCellHeight();\r\n    };\r\n    TableFacet.prototype.initRowOffsets = function () {\r\n        var _this = this;\r\n        var dataSet = this.cfg.dataSet;\r\n        var heightByField = get(this.spreadsheet, 'options.style.rowCfg.heightByField', {});\r\n        if (Object.keys(heightByField).length) {\r\n            var data = dataSet.getDisplayDataSet();\r\n            this.rowOffsets = [0];\r\n            var lastOffset_1 = 0;\r\n            data.forEach(function (_, idx) {\r\n                var _a;\r\n                var currentHeight = (_a = heightByField[String(idx)]) !== null && _a !== void 0 ? _a : _this.getDefaultCellHeight();\r\n                var currentOffset = lastOffset_1 + currentHeight;\r\n                _this.rowOffsets.push(currentOffset);\r\n                lastOffset_1 = currentOffset;\r\n            });\r\n        }\r\n    };\r\n    TableFacet.prototype.getViewCellHeights = function () {\r\n        var _this = this;\r\n        var dataSet = this.cfg.dataSet;\r\n        this.initRowOffsets();\r\n        var defaultCellHeight = this.getDefaultCellHeight();\r\n        return {\r\n            getTotalHeight: function () {\r\n                if (_this.rowOffsets) {\r\n                    return last(_this.rowOffsets);\r\n                }\r\n                return defaultCellHeight * dataSet.getDisplayDataSet().length;\r\n            },\r\n            getCellOffsetY: function (offset) {\r\n                if (offset <= 0)\r\n                    return 0;\r\n                if (_this.rowOffsets) {\r\n                    return _this.rowOffsets[offset];\r\n                }\r\n                var totalOffset = 0;\r\n                for (var index = 0; index < offset; index++) {\r\n                    totalOffset += defaultCellHeight;\r\n                }\r\n                return totalOffset;\r\n            },\r\n            getTotalLength: function () {\r\n                return dataSet.getDisplayDataSet().length;\r\n            },\r\n            getIndexRange: function (minHeight, maxHeight) {\r\n                if (_this.rowOffsets) {\r\n                    return getIndexRangeWithOffsets(_this.rowOffsets, minHeight, maxHeight);\r\n                }\r\n                var yMin = Math.floor(minHeight / defaultCellHeight);\r\n                // 防止数组index溢出导致报错\r\n                var yMax = maxHeight % defaultCellHeight === 0\r\n                    ? maxHeight / defaultCellHeight - 1\r\n                    : Math.floor(maxHeight / defaultCellHeight);\r\n                return {\r\n                    start: Math.max(0, yMin),\r\n                    end: Math.max(0, yMax),\r\n                };\r\n            },\r\n        };\r\n    };\r\n    TableFacet.prototype.init = function () {\r\n        _super.prototype.init.call(this);\r\n        var _a = this.panelBBox, width = _a.width, height = _a.height;\r\n        this.spreadsheet.panelGroup.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: 0,\r\n                y: this.cornerBBox.height,\r\n                width: width,\r\n                height: height,\r\n            },\r\n        });\r\n    };\r\n    TableFacet.prototype.getColHeader = function () {\r\n        if (!this.columnHeader) {\r\n            var _a = this.panelBBox, x = _a.x, width = _a.width, viewportHeight = _a.viewportHeight, viewportWidth = _a.viewportWidth;\r\n            return new TableColHeader({\r\n                width: width,\r\n                height: this.cornerBBox.height,\r\n                viewportWidth: viewportWidth,\r\n                viewportHeight: viewportHeight,\r\n                cornerWidth: this.cornerBBox.width,\r\n                position: { x: x, y: 0 },\r\n                data: this.layoutResult.colNodes,\r\n                scrollContainsRowHeader: this.cfg.spreadsheet.isScrollContainsRowHeader(),\r\n                sortParam: this.cfg.spreadsheet.store.get('sortParam'),\r\n                spreadsheet: this.spreadsheet,\r\n            });\r\n        }\r\n        return this.columnHeader;\r\n    };\r\n    TableFacet.prototype.updateRowResizeArea = function () {\r\n        var _a = this.spreadsheet, foregroundGroup = _a.foregroundGroup, options = _a.options;\r\n        var resize = get(options, 'interaction.resize');\r\n        var shouldDrawResize = isBoolean(resize)\r\n            ? resize\r\n            : resize === null || resize === void 0 ? void 0 : resize.rowCellVertical;\r\n        if (!shouldDrawResize) {\r\n            return;\r\n        }\r\n        var rowResizeGroup = foregroundGroup.findById(KEY_GROUP_ROW_RESIZE_AREA);\r\n        var rowResizeFrozenGroup = foregroundGroup.findById(KEY_GROUP_FROZEN_ROW_RESIZE_AREA);\r\n        if (rowResizeGroup) {\r\n            rowResizeGroup.set('children', []);\r\n        }\r\n        if (rowResizeFrozenGroup) {\r\n            rowResizeFrozenGroup.set('children', []);\r\n        }\r\n        var allCells = getAllChildCells(this.panelGroup.getChildren(), TableRowCell);\r\n        allCells.forEach(function (cell) {\r\n            cell.drawResizeArea();\r\n        });\r\n    };\r\n    TableFacet.prototype.render = function () {\r\n        this.calculateFrozenGroupInfo();\r\n        this.renderFrozenPanelCornerGroup();\r\n        _super.prototype.render.call(this);\r\n        this.initFrozenGroupPosition();\r\n    };\r\n    TableFacet.prototype.calculateFrozenGroupInfo = function () {\r\n        var _a = this.getFrozenOptions(), frozenColCount = _a.frozenColCount, frozenRowCount = _a.frozenRowCount, frozenTrailingColCount = _a.frozenTrailingColCount, frozenTrailingRowCount = _a.frozenTrailingRowCount;\r\n        var colLeafNodes = this.layoutResult.colLeafNodes;\r\n        var viewCellHeights = this.viewCellHeights;\r\n        var cellRange = this.getCellRange();\r\n        var _b = this.frozenGroupInfo, col = _b.col, row = _b.row, trailingCol = _b.trailingCol, trailingRow = _b.trailingRow;\r\n        if (frozenColCount > 0) {\r\n            col.width =\r\n                colLeafNodes[frozenColCount - 1].x +\r\n                    colLeafNodes[frozenColCount - 1].width -\r\n                    0;\r\n            col.range = [0, frozenColCount - 1];\r\n        }\r\n        if (frozenRowCount > 0) {\r\n            row.height =\r\n                viewCellHeights.getCellOffsetY(cellRange.start + frozenRowCount) -\r\n                    viewCellHeights.getCellOffsetY(cellRange.start);\r\n            row.range = [cellRange.start, cellRange.start + frozenRowCount];\r\n        }\r\n        if (frozenTrailingColCount > 0) {\r\n            trailingCol.width =\r\n                colLeafNodes[colLeafNodes.length - 1].x -\r\n                    colLeafNodes[colLeafNodes.length - frozenTrailingColCount].x +\r\n                    colLeafNodes[colLeafNodes.length - 1].width;\r\n            trailingCol.range = [\r\n                colLeafNodes.length - frozenTrailingColCount,\r\n                colLeafNodes.length - 1,\r\n            ];\r\n        }\r\n        if (frozenTrailingRowCount > 0) {\r\n            trailingRow.height =\r\n                viewCellHeights.getCellOffsetY(cellRange.end + 1) -\r\n                    viewCellHeights.getCellOffsetY(cellRange.end + 1 - frozenTrailingRowCount);\r\n            trailingRow.range = [\r\n                cellRange.end - frozenTrailingRowCount,\r\n                cellRange.end,\r\n            ];\r\n        }\r\n    };\r\n    TableFacet.prototype.getRowHeader = function () {\r\n        return null;\r\n    };\r\n    TableFacet.prototype.getSeriesNumberHeader = function () {\r\n        return null;\r\n    };\r\n    TableFacet.prototype.translateRelatedGroups = function (scrollX, scrollY, hRowScroll) {\r\n        translateGroupX(this.spreadsheet.frozenRowGroup, this.cornerBBox.width - scrollX);\r\n        translateGroupX(this.spreadsheet.frozenTrailingRowGroup, this.cornerBBox.width - scrollX);\r\n        translateGroupY(this.spreadsheet.frozenColGroup, this.cornerBBox.height - scrollY);\r\n        translateGroupY(this.spreadsheet.frozenTrailingColGroup, this.cornerBBox.height - scrollY);\r\n        _super.prototype.translateRelatedGroups.call(this, scrollX, scrollY, hRowScroll);\r\n        this.updateRowResizeArea();\r\n        this.renderFrozenGroupSplitLine(scrollX, scrollY);\r\n    };\r\n    TableFacet.prototype.calculateXYIndexes = function (scrollX, scrollY) {\r\n        var colLength = this.layoutResult.colLeafNodes.length;\r\n        var cellRange = this.getCellRange();\r\n        var _a = this.panelBBox, height = _a.viewportHeight, width = _a.viewportWidth;\r\n        var _b = this.getFrozenOptions(), frozenColCount = _b.frozenColCount, frozenRowCount = _b.frozenRowCount, frozenTrailingColCount = _b.frozenTrailingColCount, frozenTrailingRowCount = _b.frozenTrailingRowCount;\r\n        var finalViewport = {\r\n            width: width,\r\n            height: height,\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n        if (frozenTrailingColCount > 0 || frozenColCount > 0) {\r\n            var _c = this.frozenGroupInfo, trailingCol = _c.trailingCol, col = _c.col;\r\n            finalViewport.width -= trailingCol.width + col.width;\r\n            finalViewport.x += col.width;\r\n        }\r\n        if (frozenTrailingRowCount > 0 || frozenRowCount > 0) {\r\n            var _d = this.frozenGroupInfo, row = _d.row, trailingRow = _d.trailingRow;\r\n            finalViewport.height -= row.height + trailingRow.height;\r\n            finalViewport.y += row.height;\r\n        }\r\n        var indexes = calculateInViewIndexes(scrollX, scrollY, this.viewCellWidths, this.viewCellHeights, finalViewport, this.getRealScrollX(this.cornerBBox.width));\r\n        this.panelScrollGroupIndexes = indexes;\r\n        return splitInViewIndexesWithFrozen(indexes, {\r\n            frozenColCount: frozenColCount,\r\n            frozenRowCount: frozenRowCount,\r\n            frozenTrailingColCount: frozenTrailingColCount,\r\n            frozenTrailingRowCount: frozenTrailingRowCount,\r\n        }, colLength, cellRange);\r\n    };\r\n    // 对 panelScrollGroup 以及四个方向的 frozenGroup 做 Clip，避免有透明度时冻结分组和滚动分组展示重叠\r\n    TableFacet.prototype.clip = function (scrollX, scrollY) {\r\n        var _a, _b;\r\n        var colLeafNodes = this.layoutResult.colLeafNodes;\r\n        var paginationScrollY = this.getPaginationScrollY();\r\n        var _c = this.spreadsheet, frozenRowGroup = _c.frozenRowGroup, frozenColGroup = _c.frozenColGroup, frozenTrailingColGroup = _c.frozenTrailingColGroup, frozenTrailingRowGroup = _c.frozenTrailingRowGroup, panelScrollGroup = _c.panelScrollGroup;\r\n        var frozenColGroupWidth = frozenColGroup.getBBox().width;\r\n        var frozenRowGroupHeight = frozenRowGroup.getBBox().height;\r\n        var frozenTrailingColBBox = frozenTrailingColGroup.getBBox();\r\n        var frozenTrailingRowGroupHeight = frozenTrailingRowGroup.getBBox().height;\r\n        var panelScrollGroupWidth = this.panelBBox.width -\r\n            frozenColGroupWidth -\r\n            frozenTrailingColGroup.getBBox().width;\r\n        var panelScrollGroupHeight = this.panelBBox.height -\r\n            frozenRowGroupHeight -\r\n            frozenTrailingRowGroupHeight;\r\n        panelScrollGroup.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: scrollX + frozenColGroupWidth,\r\n                y: scrollY + frozenRowGroupHeight,\r\n                width: panelScrollGroupWidth,\r\n                height: panelScrollGroupHeight,\r\n            },\r\n        });\r\n        frozenRowGroup.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: scrollX + frozenColGroupWidth,\r\n                y: paginationScrollY,\r\n                width: panelScrollGroupWidth,\r\n                height: frozenRowGroupHeight,\r\n            },\r\n        });\r\n        frozenTrailingRowGroup.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: scrollX + frozenColGroupWidth,\r\n                y: frozenTrailingRowGroup.getBBox().minY,\r\n                width: panelScrollGroupWidth,\r\n                height: frozenTrailingRowGroupHeight,\r\n            },\r\n        });\r\n        frozenColGroup.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: 0,\r\n                y: scrollY + frozenRowGroupHeight,\r\n                width: frozenColGroupWidth,\r\n                height: panelScrollGroupHeight,\r\n            },\r\n        });\r\n        frozenTrailingColGroup.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: frozenTrailingColBBox.minX,\r\n                y: scrollY + frozenRowGroupHeight,\r\n                width: frozenTrailingColBBox.width,\r\n                height: panelScrollGroupHeight,\r\n            },\r\n        });\r\n        var rowResizeGroup = this.spreadsheet.foregroundGroup.findById(KEY_GROUP_ROW_RESIZE_AREA);\r\n        if (rowResizeGroup) {\r\n            rowResizeGroup.setClip({\r\n                type: 'rect',\r\n                attrs: {\r\n                    x: 0,\r\n                    y: frozenRowGroupHeight + this.cornerBBox.height,\r\n                    width: (_b = (_a = colLeafNodes === null || colLeafNodes === void 0 ? void 0 : colLeafNodes[0]) === null || _a === void 0 ? void 0 : _a.width) !== null && _b !== void 0 ? _b : 0,\r\n                    height: panelScrollGroupHeight,\r\n                },\r\n            });\r\n        }\r\n    };\r\n    return TableFacet;\r\n}(BaseFacet));\r\nexport { TableFacet };\r\n//# sourceMappingURL=table-facet.js.map","references":["F:/Ismart/S2-master/node_modules/@antv/g-canvas/lib/index.d.ts","F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/header/table-col.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/header/col.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/cell/table-col-cell.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/layout/frozen.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/facet.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/utils.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/bbox/cornerBBox.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/header/index.ts","F:/Ismart/S2-master/packages/s2-core/src/cell/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/cell/data-cell.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/frozen.ts","F:/Ismart/S2-master/packages/s2-core/src/common/debug/index.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/base-facet.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/build-header-hierarchy.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/hierarchy.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/layout-hooks.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/node.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/g-renders.ts","F:/Ismart/S2-master/packages/s2-core/src/data-set/index.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/indexes.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/text.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/get-all-child-cells.ts"],"map":"{\"version\":3,\"file\":\"table-facet.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/facet/table-facet.ts\"],\"names\":[],\"mappings\":\";AACA,OAAO,EAAE,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,QAAQ,CAAC;AAC1D,OAAO,EAAE,cAAc,EAAE,2BAAmC;AAE5D,OAAO,EAAE,2BAA2B,EAAE,qCAAsC;AAC5E,OAAO,EAAE,qBAAqB,EAAE,+BAAgC;AAChE,OAAO,EAAE,wBAAwB,EAAE,uBAAwB;AAC3D,OAAO,EACL,0BAA0B,EAC1B,sBAAsB,EACtB,qBAAqB,EACrB,4BAA4B,EAC5B,cAAc,EACd,eAAe,EACf,eAAe,EACf,mBAAmB,EACnB,mBAAmB,GACpB,MAAM,SAAS,CAAC;AACjB,OAAO,EAAE,UAAU,EAAE,MAAM,mBAAmB,CAAC;AAE/C,OAAO,EAAE,YAAY,EAAE,gBAAe;AAUtC,OAAO,EAAE,aAAa,EAAE,gCAA+B;AACvD,OAAO,EACL,yBAAyB,EACzB,gBAAgB,EAChB,OAAO,EACP,mBAAmB,EACnB,qCAAqC,EACrC,2BAA2B,EAC3B,gCAAgC,GACjC,2BAA0B;AAC3B,OAAO,EAAE,kBAAkB,EAAE,kCAAiC;AAC9D,OAAO,EAAE,YAAY,EAAE,wBAAuB;AAC9C,OAAO,EAAE,SAAS,EAAE,qBAA2B;AAC/C,OAAO,EAAE,oBAAoB,EAAE,wCAA8C;AAC7E,OAAO,EAAE,SAAS,EAAE,2BAAiC;AACrD,OAAO,EAAE,gBAAgB,EAAE,8BAAoC;AAC/D,OAAO,EAAE,IAAI,EAAE,sBAA4B;AAC3C,OAAO,EAAE,UAAU,EAAE,2BAA0B;AAG/C,OAAO,EAAE,gBAAgB,EAAE,uBAAuB,EAAE,sBAAqB;AACzE,OAAO,EAAE,gBAAgB,EAAE,qCAAoC;AAE/D;IAAgC,8BAAS;IA2BvC,oBAAmB,GAAwB;QAA3C,YACE,kBAAM,GAAG,CAAC,SAyDX;QAlFM,qBAAe,GAOlB;YACF,GAAG,EAAE;gBACH,KAAK,EAAE,CAAC;aACT;YACD,GAAG,EAAE;gBACH,MAAM,EAAE,CAAC;aACV;YACD,WAAW,EAAE;gBACX,MAAM,EAAE,CAAC;aACV;YACD,WAAW,EAAE;gBACX,KAAK,EAAE,CAAC;aACT;SACF,CAAC;QAEK,6BAAuB,GAAG,EAAE,CAAC;QAsa1B,6BAAuB,GAAG;YAC5B,IAAA,KAAuB,KAAI,CAAC,eAAe,EAAE,EAA3C,OAAO,aAAA,EAAE,OAAO,aAA2B,CAAC;YACpD,IAAM,iBAAiB,GAAG,KAAI,CAAC,oBAAoB,EAAE,CAAC;YAEtD,cAAc,CACZ,KAAI,CAAC,WAAW,CAAC,cAAc,EAC/B,KAAI,CAAC,UAAU,CAAC,KAAK,GAAG,OAAO,EAC/B,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,iBAAiB,CAC3C,CAAC;YACF,cAAc,CACZ,KAAI,CAAC,WAAW,CAAC,cAAc,EAC/B,KAAI,CAAC,UAAU,CAAC,KAAK,EACrB,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,OAAO,GAAG,iBAAiB,CACrD,CAAC;YACF,cAAc,CACZ,KAAI,CAAC,WAAW,CAAC,sBAAsB,EACvC,KAAI,CAAC,UAAU,CAAC,KAAK,EACrB,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,OAAO,GAAG,iBAAiB,CACrD,CAAC;YACF,cAAc,CACZ,KAAI,CAAC,WAAW,CAAC,cAAc,EAC/B,KAAI,CAAC,UAAU,CAAC,KAAK,EACrB,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,iBAAiB,CAC3C,CAAC;QACJ,CAAC,CAAC;QAEK,4BAAsB,GAAG,UAAC,KAAa,EAAE,GAAW;YACzD,IAAI,KAAK,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC;gBAAE,OAAO,CAAC,CAAC;YAEnC,IAAI,KAAI,CAAC,UAAU,EAAE;gBACnB,OAAO,KAAI,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,KAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;aAC1D;YAED,IAAI,WAAW,GAAG,CAAC,CAAC;YACpB,KAAK,IAAI,KAAK,GAAG,KAAK,EAAE,KAAK,GAAG,GAAG,GAAG,CAAC,EAAE,KAAK,EAAE,EAAE;gBAChD,IAAM,MAAM,GAAG,KAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC3C,WAAW,IAAI,MAAM,CAAC;aACvB;YACD,OAAO,WAAW,CAAC;QACrB,CAAC,CAAC;QAEM,mBAAa,GAAG,UAAC,KAAa;;YACpC,IAAM,KAAK,GAAc,GAAG,CAAC,KAAI,CAAC,GAAG,EAAE,6BAA6B,CAAC,CAAC;YACtE,OAAO,aAAM,KAAK,iBAAO,MAAA,KAAK,CAAC,YAAY,0CAAE,IAAI,gBAAM,MAAA,KAAK,CAAC,YAAY,0CAAE,KAAK,CAAE,CAAC;QACrF,CAAC,CAAC;QAEQ,gCAA0B,GAAG,UAAC,OAAe,EAAE,OAAe;;YAChE,IAAA,KAKF,KAAI,CAAC,SAAS,EAJT,UAAU,WAAA,EACT,WAAW,YAAA,EACnB,aAAa,mBAAA,EACb,cAAc,oBACE,CAAC;YACX,IAAQ,YAAY,GAAK,KAAI,CAAC,UAAU,OAApB,CAAqB;YACjD,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC;YACpD,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,EAAE,CAAC;YACtC,IAAM,UAAU,GAAG,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,KAAK,CAAC;YAC7C,IAAA,KAKF,qBAAqB,CACvB,KAAI,CAAC,WAAW,CAAC,OAAO,EACxB,YAAY,CAAC,MAAM,EACnB,UAAU,CACX,EARC,cAAc,oBAAA,EACd,cAAc,oBAAA,EACd,sBAAsB,4BAAA,EACtB,sBAAsB,4BAKvB,CAAC;YAEF,sBAAsB;YACtB,IAAM,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,KAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC;YAE1E,kBAAkB;YAClB,IAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,KAAI,CAAC,cAAc,CAAC,GAAG,aAAa,CAAC,CAAC;YAC1E,IAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CACzB,CAAC,EACD,KAAI,CAAC,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,CAAC;gBACpD,KAAI,CAAC,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,KAAK,CAAC;gBACpD,cAAc,CACjB,CAAC;YAEF,kCAAkC;YAClC,MAAA,KAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,2BAA2B,CAAC,0CAAE,MAAM,EAAE,CAAC;YAErE,IAAM,KAAK,GAAc,GAAG,CAAC,KAAI,CAAC,GAAG,EAAE,6BAA6B,CAAC,CAAC;YACtE,IAAM,cAAc,GAAG,KAAI,CAAC,eAAe,CAAC,QAAQ,CAAC;gBACnD,EAAE,EAAE,2BAA2B;gBAC/B,MAAM,EAAE,qCAAqC;aAC9C,CAAC,CAAC;YAEH,IAAM,mBAAmB,GAAG;gBAC1B,SAAS,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,mBAAmB;gBACrC,MAAM,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,mBAAmB;gBAClC,OAAO,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,0BAA0B;aAC3C,CAAC;YAEF,IAAM,qBAAqB,GAAG;gBAC5B,SAAS,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,qBAAqB;gBACvC,MAAM,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,qBAAqB;gBACpC,OAAO,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,4BAA4B;aAC7C,CAAC;YAEF,IAAI,cAAc,GAAG,CAAC,EAAE;gBACtB,IAAM,CAAC,GAAG,YAAY,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI,EAAE,GAAG;oBAC5C,IAAI,GAAG,GAAG,cAAc,EAAE;wBACxB,OAAO,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;qBAC1B;oBACD,OAAO,IAAI,CAAC;gBACd,CAAC,EAAE,CAAC,CAAC,CAAC;gBAEN,IAAM,MAAM,GAAG,sBAAsB,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,cAAc,CAAC;gBAEzE,UAAU,CACR,cAAuB,EACvB;oBACE,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,YAAY;oBAChB,EAAE,EAAE,YAAY,GAAG,MAAM;iBAC1B,eAEI,mBAAmB,EAEzB,CAAC;gBAEF,IAAI,KAAK,CAAC,UAAU,IAAI,OAAO,GAAG,CAAC,EAAE;oBACnC,cAAc,CAAC,QAAQ,CAAC,MAAM,EAAE;wBAC9B,KAAK,EAAE;4BACL,CAAC,GAAA;4BACD,CAAC,EAAE,YAAY;4BACf,KAAK,EAAE,KAAK,CAAC,WAAW;4BACxB,MAAM,QAAA;4BACN,IAAI,EAAE,KAAI,CAAC,aAAa,CAAC,CAAC,CAAC;yBAC5B;qBACF,CAAC,CAAC;iBACJ;aACF;YAED,IAAI,cAAc,GAAG,CAAC,EAAE;gBACtB,IAAM,CAAC,GACL,YAAY;oBACZ,KAAI,CAAC,sBAAsB,CACzB,SAAS,CAAC,KAAK,EACf,SAAS,CAAC,KAAK,GAAG,cAAc,GAAG,CAAC,CACrC,CAAC;gBACJ,IAAM,KAAK,GAAG,sBAAsB,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,aAAa,CAAC;gBACtE,UAAU,CACR,cAAuB,EACvB;oBACE,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,KAAK;oBACT,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,CAAC;iBACN,eAEI,qBAAqB,EAE3B,CAAC;gBAEF,IAAI,KAAK,CAAC,UAAU,IAAI,eAAe,GAAG,CAAC,EAAE;oBAC3C,cAAc,CAAC,QAAQ,CAAC,MAAM,EAAE;wBAC9B,KAAK,EAAE;4BACL,CAAC,EAAE,CAAC;4BACJ,CAAC,EAAE,CAAC;4BACJ,KAAK,EAAE,KAAK;4BACZ,MAAM,EAAE,KAAK,CAAC,WAAW;4BACzB,IAAI,EAAE,KAAI,CAAC,aAAa,CAAC,EAAE,CAAC;yBAC7B;qBACF,CAAC,CAAC;iBACJ;aACF;YAED,IAAI,sBAAsB,GAAG,CAAC,EAAE;gBAC9B,IAAM,KAAK,GAAG,YAAY,CAAC,WAAW,CAAC,UAAC,IAAI,EAAE,IAAI,EAAE,GAAG;oBACrD,IAAI,GAAG,IAAI,YAAY,CAAC,MAAM,GAAG,sBAAsB,EAAE;wBACvD,OAAO,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;qBAC1B;oBACD,OAAO,IAAI,CAAC;gBACd,CAAC,EAAE,CAAC,CAAC,CAAC;gBAEN,IAAM,CAAC,GAAG,UAAU,GAAG,KAAK,CAAC;gBAC7B,IAAM,MAAM,GAAG,sBAAsB,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,cAAc,CAAC;gBACrE,UAAU,CACR,cAAuB,EACvB;oBACE,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,YAAY;oBAChB,EAAE,EAAE,YAAY,GAAG,MAAM;iBAC1B,eAEI,mBAAmB,EAEzB,CAAC;gBAEF,IAAI,KAAK,CAAC,UAAU,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE;oBACpE,cAAc,CAAC,QAAQ,CAAC,MAAM,EAAE;wBAC9B,KAAK,EAAE;4BACL,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,WAAW;4BACxB,CAAC,EAAE,YAAY;4BACf,KAAK,EAAE,KAAK,CAAC,WAAW;4BACxB,MAAM,QAAA;4BACN,IAAI,EAAE,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC;yBAC9B;qBACF,CAAC,CAAC;iBACJ;aACF;YAED,IAAI,sBAAsB,GAAG,CAAC,EAAE;gBAC9B,IAAM,CAAC,GACL,KAAI,CAAC,SAAS,CAAC,IAAI;oBACnB,KAAI,CAAC,sBAAsB,CACzB,SAAS,CAAC,GAAG,GAAG,sBAAsB,GAAG,CAAC,EAC1C,SAAS,CAAC,GAAG,CACd,CAAC;gBACJ,IAAM,KAAK,GAAG,sBAAsB,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,aAAa,CAAC;gBACtE,UAAU,CACR,cAAuB,EACvB;oBACE,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,KAAK;oBACT,EAAE,EAAE,CAAC;oBACL,EAAE,EAAE,CAAC;iBACN,eAEI,qBAAqB,EAE3B,CAAC;gBAEF,IAAI,KAAK,CAAC,UAAU,IAAI,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE;oBAChE,cAAc,CAAC,QAAQ,CAAC,MAAM,EAAE;wBAC9B,KAAK,EAAE;4BACL,CAAC,EAAE,CAAC;4BACJ,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,WAAW;4BACxB,KAAK,OAAA;4BACL,MAAM,EAAE,KAAK,CAAC,WAAW;4BACzB,IAAI,EAAE,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC;yBAC9B;qBACF,CAAC,CAAC;iBACJ;aACF;YACD,KAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC;QAC9B,CAAC,CAAC;QAEQ,kCAA4B,GAAG;YACvC,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,CAAC;YACxD,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,EAAE,CAAC;YAEhC,IAAA,KAKF,qBAAqB,CACvB,KAAI,CAAC,WAAW,CAAC,OAAO,EACxB,SAAS,EACT,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,KAAK,GAAG,CAAC,CACpC,EARC,cAAc,oBAAA,EACd,cAAc,oBAAA,EACd,sBAAsB,4BAAA,EACtB,sBAAsB,4BAKvB,CAAC;YAEF,IAAM,MAAM,GAAG,0BAA0B,CACvC;gBACE,cAAc,gBAAA;gBACd,cAAc,gBAAA;gBACd,sBAAsB,wBAAA;gBACtB,sBAAsB,wBAAA;aACvB,EACD,SAAS,EACT,SAAS,CACV,CAAC;YAEF,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAC,GAAG;gBAC9B,IAAM,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;gBAC1B,IAAM,KAAK,GAAG,KAAI,CAAC,WAAW,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC,CAAC;gBACxD,IAAI,KAAK,EAAE;oBACT,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;wBACjB,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;oBAC5C,CAAC,CAAC,CAAC;iBACJ;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,mBAAa,GAAG,UAAC,QAAgB,EAAE,QAAgB,EAAE,KAAa;YAChE,IAAM,QAAQ,GAAG,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;YACnE,IAAI,QAAQ,EAAE;gBACZ,IAAM,IAAI,GAAG,KAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBACzC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;aACjB;QACH,CAAC,CAAC;QAEF,aAAO,GAAG,UAAC,IAA0B;YAC7B,IAAA,KAKF,KAAI,CAAC,WAAW,CAAC,OAAO,EAJ1B,cAAc,oBAAA,EACd,cAAc,oBAAA,EACd,sBAAsB,4BAAA,EACtB,sBAAsB,4BACI,CAAC;YAC7B,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YACrE,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,EAAE,CAAC;YAEtC,IAAM,cAAc,GAAG,qBAAqB,CAC1C,IAAI,CAAC,OAAO,EAAE,EACd;gBACE,cAAc,gBAAA;gBACd,cAAc,gBAAA;gBACd,sBAAsB,wBAAA;gBACtB,sBAAsB,wBAAA;aACvB,EACD,SAAS,EACT,SAAS,CACV,CAAC;YAEF,IAAM,KAAK,GAAG,kBAAkB,CAAC,cAAc,CAAC,CAAC;YACjD,IAAI,KAAK,EAAE;gBACR,KAAI,CAAC,WAAW,CAAC,KAAK,CAAW,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;aAC9C;QACH,CAAC,CAAC;QA0EM,sBAAgB,GAAG;YACzB,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,CAAC;YACxD,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,EAAE,CAAC;YAEtC,OAAO,qBAAqB,CAC1B,KAAI,CAAC,GAAG,EACR,SAAS,EACT,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,KAAK,GAAG,CAAC,CACpC,CAAC;QACJ,CAAC,CAAC;QA9yBA,IAAM,EAAE,GAAG,KAAI,CAAC,WAAW,CAAC;QAC5B,EAAE,CAAC,EAAE,CAAC,OAAO,CAAC,UAAU,EAAE,UAAC,UAAU;YACnC,IAAI,MAAM,GAAG,UAAU,CAAC;YACxB,yBAAyB;YACzB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;gBAC9B,MAAM,GAAG,CAAC,UAAU,CAAC,CAAC;aACvB;YACD,GAAG,CACD,EAAE,CAAC,OAAO,EACV,YAAY,EACZ,MAAM,CAAC,GAAG,CAAC,UAAC,IAAoB;;gBAAK,OAAA,uBAChC,IAAI;oBACP,mBAAmB;oBACnB,WAAW,EAAE,MAAA,IAAI,CAAC,OAAO,mCAAI,IAAI,CAAC,WAAW,IAC7C,CAAA;aAAA,CAAC,CACJ,CAAC;YACF,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;YAC1B,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAChB,EAAE,CAAC,IAAI,CACL,OAAO,CAAC,YAAY,EACnB,EAAE,CAAC,OAAwB,CAAC,iBAAiB,EAAE,CACjD,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,EAAE,CAAC,OAAO,CAAC,YAAY,EAAE,UAAC,MAAM;YACjC,gFAAgF;YAChF,IAAM,QAAQ,GACZ,CAAC,MAAM,CAAC,cAAc,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,KAAK,CAAC,CAAC;YAE/D,IAAM,SAAS,GAAG,EAAE,CAAC,OAAO,CAAC,YAAY,IAAI,EAAE,CAAC;YAChD,qFAAqF;YACrF,IAAM,QAAQ,GAAG,SAAS,CAAC,SAAS,CAClC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,SAAS,KAAK,MAAM,CAAC,SAAS,EAAnC,CAAmC,CAC9C,CAAC;YAEF,IAAI,QAAQ,KAAK,CAAC,CAAC,EAAE;gBACnB,IAAI,QAAQ,EAAE;oBACZ,4EAA4E;oBAC5E,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;iBAC5B;qBAAM;oBACL,qDAAqD;oBACrD,SAAS,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC;iBAC9B;aACF;iBAAM;gBACL,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACxB;YAED,GAAG,CAAC,EAAE,CAAC,OAAO,EAAE,cAAc,EAAE,SAAS,CAAC,CAAC;YAE3C,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAChB,EAAE,CAAC,IAAI,CACL,OAAO,CAAC,cAAc,EACrB,EAAE,CAAC,OAAwB,CAAC,iBAAiB,EAAE,CACjD,CAAC;QACJ,CAAC,CAAC,CAAC;;IACL,CAAC;IAED,sBAAI,qCAAa;aAAjB;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;QAC9C,CAAC;;;OAAA;IAES,wCAAmB,GAA7B;QACU,IAAA,aAAa,GAAK,IAAI,CAAC,YAAY,cAAtB,CAAuB;QAC5C,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAEhD,IAAI,CAAC,UAAU,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC;QAEvC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC;QAChC,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC;IAChC,CAAC;IAEM,4BAAO,GAAd;QACE,iBAAM,OAAO,WAAE,CAAC;QAChB,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;QACzC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;IAC7C,CAAC;IAES,6BAAQ,GAAlB;QAAA,iBA4FC;QA3FO,IAAA,KAA2B,IAAI,CAAC,GAAG,EAAjC,OAAO,aAAA,EAAE,WAAW,iBAAa,CAAC;QAE1C,IAAM,aAAa,GAAG,IAAI,SAAS,EAAE,CAAC;QAChC,IAAA,KACJ,oBAAoB,CAAC;YACnB,WAAW,EAAE,KAAK;YAClB,QAAQ,EAAE,IAAI,CAAC,GAAG;SACnB,CAAC,EAJe,YAAY,eAAA,EAAa,aAAa,eAIrD,CAAC;QACL,IAAI,CAAC,2BAA2B,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC;QAE9D,IAAM,WAAW,GAAG,UAAC,QAAgB,EAAE,QAAgB;;YACrD,IAAM,gBAAgB,GAAG,KAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC;YACnD,IAAM,GAAG,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;YACnC,IAAM,UAAU,GAAG,KAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAEhD,IAAM,SAAS,GAAG,KAAI,CAAC,YAAY,EAAE,CAAC;YAChC,IAAA,KACJ,qBAAqB,CACnB,KAAI,CAAC,GAAG,EACR,YAAY,CAAC,MAAM,EACnB,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,KAAK,GAAG,CAAC,CACpC,EALK,sBAAsB,4BAAA,EAAE,sBAAsB,4BAKnD,CAAC;YAEJ,IAAI,IAAI,CAAC;YAET,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC;YAClC,IAAM,SAAS,GAAG,YAAY,CAAC,MAAM,CAAC;YAEtC,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;YACd,IAAI,CAAC,GAAG,KAAI,CAAC,eAAe,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;YAEtD,IACE,mBAAmB,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,EAAE,sBAAsB,CAAC,EACpE;gBACA,CAAC;oBACC,KAAI,CAAC,SAAS,CAAC,IAAI;wBACnB,KAAI,CAAC,sBAAsB,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;aACxD;YAED,IAAI,mBAAmB,CAAC,QAAQ,EAAE,sBAAsB,EAAE,SAAS,CAAC,EAAE;gBACpE,CAAC;oBACC,KAAK;wBACL,YAAY;6BACT,KAAK,CAAC,CAAC,CAAC,SAAS,GAAG,QAAQ,CAAC,CAAC;6BAC9B,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI,EAAE,GAAG;4BACtB,OAAO,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;wBAC3B,CAAC,EAAE,CAAC,CAAC,CAAC;aACX;YAED,IAAI,gBAAgB,IAAI,GAAG,CAAC,KAAK,KAAK,mBAAmB,EAAE;gBACzD,IAAI,GAAG,QAAQ,GAAG,CAAC,CAAC;aACrB;iBAAM;gBACL,IAAI,GAAG,OAAO,CAAC,WAAW,CAAC;oBACzB,KAAK,EAAE;wBACL,GAAG,EAAE,GAAG,CAAC,KAAK;wBACd,QAAQ,UAAA;qBACT;iBACF,CAAC,CAAC;aACJ;YACD,OAAO;gBACL,WAAW,aAAA;gBACX,CAAC,GAAA;gBACD,CAAC,GAAA;gBACD,KAAK,EAAE,GAAG,CAAC,KAAK;gBAChB,MAAM,EAAE,UAAU;gBAClB,IAAI;oBACF,GAAC,GAAG,CAAC,KAAK,IAAG,IAAI;uBAClB;gBACD,QAAQ,UAAA;gBACR,QAAQ,UAAA;gBACR,QAAQ,EAAE,KAAK;gBACf,KAAK,EAAE,GAAG,CAAC,EAAE;gBACb,KAAK,EAAE,MAAM,CAAC,QAAQ,CAAC;gBACvB,UAAU,EAAE,GAAG,CAAC,KAAK;gBACrB,UAAU,EAAE,IAAI;gBAChB,EAAE,EAAE,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC;aAChC,CAAC;QAChB,CAAC,CAAC;QAEF,IAAM,YAAY,GAAG;YACnB,QAAQ,EAAE,aAAa,CAAC,QAAQ,EAAE;YAClC,aAAa,eAAA;YACb,QAAQ,EAAE,aAAa,CAAC,QAAQ,EAAE;YAClC,aAAa,eAAA;YACb,YAAY,EAAE,aAAa,CAAC,SAAS,EAAE;YACvC,YAAY,cAAA;YACZ,WAAW,aAAA;YACX,WAAW,aAAA;SACI,CAAC;QAElB,OAAO,YAAY,CAAC;IACtB,CAAC;IAEO,wCAAmB,GAA3B,UAA4B,YAAoB;QACtC,IAAA,OAAO,GAAK,IAAI,CAAC,GAAG,QAAb,CAAc;QACrB,IAAA,gBAAgB,GAAK,IAAI,CAAC,GAAG,iBAAb,CAAc;QACtC,IAAI,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,KAAK,gBAAgB,CAAC,OAAO,EAAE;YACtE,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;YACtD,IAAM,gBAAgB,GAAG,YAAY,CAAC,MAAM,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1E,IAAM,OAAO,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,KAAK,GAAG,iBAAiB,CAAC;YAC7D,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC;SACzE;QACD,OAAO,OAAO,CAAC,KAAK,CAAC;IACvB,CAAC;IAEO,qCAAgB,GAAxB,UAAyB,GAAS;QACxB,IAAA,MAAM,GAAK,IAAI,CAAC,GAAG,OAAb,CAAc;QAC5B,iBAAiB;QACjB,IAAM,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACtE,OAAO,cAAc,IAAI,MAAM,CAAC,MAAM,CAAC;IACzC,CAAC;IAEO,gDAA2B,GAAnC,UACE,YAAoB,EACpB,aAAwB;;;QAExB,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QACnC,IAAM,QAAQ,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;;YAC1C,KAA0B,IAAA,KAAA,SAAA,aAAa,CAAC,uBAAuB,CAAA,gBAAA,4BAAE;gBAA5D,IAAM,WAAW,WAAA;gBACpB,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;gBACxD,aAAa,CAAC,MAAM,IAAI,WAAW,CAAC,MAAM,CAAC;aAC5C;;;;;;;;;QACO,IAAA,sBAAsB,GAAK,qBAAqB,CACtD,MAAA,IAAI,CAAC,WAAW,0CAAE,OAAO,EACzB,QAAQ,CAAC,MAAM,CAChB,uBAH6B,CAG5B;QAEF,IAAM,iBAAiB,GAAG,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;QAEjE,IAAM,KAAK,GAAG,EAAE,CAAC;QAEjB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACxC,IAAM,WAAW,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;YAEhC,WAAW,CAAC,QAAQ,GAAG,CAAC,CAAC;YACzB,WAAW,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,GAAG,WAAW,CAAC,KAAK,CAAC;YAClD,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC,0BAA0B,CACjD,WAAW,EACX,iBAAiB,CAClB,CAAC;YACF,WAAW,GAAG,WAAW,CAAC;YAC1B,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC;YAElB,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;YAExD,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAExB,gBAAgB,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;YAE9C,aAAa,CAAC,KAAK,IAAI,WAAW,CAAC,KAAK,CAAC;SAC1C;QAED,WAAW,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAE/B,IAAM,OAAO,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC;QAEzC,IAAI,sBAAsB,GAAG,CAAC,EAAE;YAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAM,WAAW,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBAElD,IACE,WAAW,CAAC,QAAQ;oBACpB,YAAY,CAAC,MAAM,GAAG,sBAAsB,EAC5C;oBACA,IAAI,WAAW,CAAC,QAAQ,KAAK,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;wBAChD,WAAW,CAAC,CAAC,GAAG,OAAO,GAAG,WAAW,CAAC,KAAK,CAAC;qBAC7C;yBAAM;wBACL,WAAW,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,GAAG,WAAW,CAAC,KAAK,CAAC;qBACnD;oBACD,WAAW,GAAG,WAAW,CAAC;iBAC3B;aACF;SACF;IACH,CAAC;IAEO,+CAA0B,GAAlC,UACE,GAAS,EACT,iBAAyB;;QAEnB,IAAA,KAAmC,IAAI,CAAC,GAAG,EAAzC,MAAM,YAAA,EAAE,OAAO,aAAA,EAAE,WAAW,iBAAa,CAAC;QAClD,IAAM,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC;QAE9D,IAAM,aAAa,GAAG,GAAG,CACvB,GAAG,CAAC,MAAM,EAAE,mBAAmB,CAAC,EAChC,UAAG,GAAG,CAAC,KAAK,CAAE,EACd,GAAG,CAAC,KAAK,CACV,CAAC;QACF,IAAI,QAAgB,CAAC;QACrB,IAAI,aAAa,EAAE;YACjB,QAAQ,GAAG,aAAa,CAAC;SAC1B;aAAM;YACL,IAAI,eAAe,KAAK,gBAAgB,CAAC,OAAO,EAAE;gBAChD,IAAM,KAAK,GAAG,OAAO,CAAC,iBAAiB,EAAE,CAAC;gBAC1C,IAAM,QAAQ,GAAG,GAAG,CAAC,KAAK,CAAC;gBAE3B,IAAM,SAAS,GACb,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,GAAG,CAAC,UAAC,IAAI,IAAK,OAAA,UAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAE,EAAlB,CAAkB,CAAC,0CAAE,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,KAAI,EAAE,CAAC,CAAC,UAAU;gBAC1E,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBACzB,IAAM,QAAQ,GAAG,KAAK,CAAC,SAAS,EAAE,UAAC,KAAK;oBACtC,OAAA,uBAAuB,CAAC,KAAK,CAAC;gBAA9B,CAA8B,CAC/B,CAAC;gBAEM,IAAY,gBAAgB,GAAK,WAAW,CAAC,KAAK,CAAC,OAAO,WAA9B,CAA+B;gBAC7D,IAAA,KACJ,WAAW,CAAC,KAAK,CAAC,QAAQ,EADd,iBAAiB,UAAA,EAAQ,SAAS,UACpB,CAAC;gBAE7B,YAAY,CAAC,WAAW,EAAE,CAAC,MAAM,CAC/B,mBAAmB,EACnB,GAAG,CAAC,KAAK,EACT,QAAQ,CACT,CAAC;gBAEF,6BAA6B;gBAC7B,IAAI,QAAQ,KAAK,QAAQ,EAAE;oBACzB,QAAQ;wBACN,gBAAgB,CAAC,QAAQ,EAAE,gBAAgB,CAAC;4BAC5C,2BAA2B,CACzB,IAAI,CAAC,WAAW,EAChB,GAAG,EACH,WAAW,CAAC,KAAK,CAAC,OAAO,CAC1B,CAAC;iBACL;qBAAM;oBACL,QAAQ;wBACN,gBAAgB,CAAC,QAAQ,EAAE,iBAAiB,CAAC;4BAC7C,SAAS,CAAC,OAAO,CAAC,IAAI;4BACtB,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC;iBAC3B;aACF;iBAAM;gBACL,QAAQ,GAAG,iBAAiB,CAAC;aAC9B;YAED,IAAI,GAAG,CAAC,KAAK,KAAK,mBAAmB,EAAE;gBACrC,QAAQ,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;aACxC;SACF;QAED,OAAO,QAAQ,CAAC;IAClB,CAAC;IAES,yCAAoB,GAA9B;;QACU,IAAA,OAAO,GAAK,IAAI,CAAC,GAAG,QAAb,CAAc;QAE7B,OAAO,CACL,OAAO,CAAC,MAAM;aACd,MAAA,IAAI,CAAC,aAAa,CAAC,OAAO,0CAAE,GAAG,CAAA;aAC/B,MAAA,IAAI,CAAC,aAAa,CAAC,OAAO,0CAAE,MAAM,CAAA,CACnC,CAAC;IACJ,CAAC;IAEM,kCAAa,GAApB,UAAqB,KAAa;QAChC,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAM,aAAa,GAAG,GAAG,CACvB,IAAI,CAAC,WAAW,EAChB,oCAAoC,EACpC,EAAE,CACH,CAAC;YAEF,IAAM,YAAY,GAAG,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;YAClD,IAAI,YAAY,EAAE;gBAChB,OAAO,YAAY,CAAC;aACrB;SACF;QACD,OAAO,IAAI,CAAC,oBAAoB,EAAE,CAAC;IACrC,CAAC;IAES,mCAAc,GAAxB;QAAA,iBAmBC;QAlBS,IAAA,OAAO,GAAK,IAAI,CAAC,GAAG,QAAb,CAAc;QAC7B,IAAM,aAAa,GAAG,GAAG,CACvB,IAAI,CAAC,WAAW,EAChB,oCAAoC,EACpC,EAAE,CACH,CAAC;QACF,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE;YACrC,IAAM,IAAI,GAAG,OAAO,CAAC,iBAAiB,EAAE,CAAC;YACzC,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,YAAU,GAAG,CAAC,CAAC;YACnB,IAAI,CAAC,OAAO,CAAC,UAAC,CAAC,EAAE,GAAG;;gBAClB,IAAM,aAAa,GACjB,MAAA,aAAa,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,mCAAI,KAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5D,IAAM,aAAa,GAAG,YAAU,GAAG,aAAa,CAAC;gBACjD,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;gBACpC,YAAU,GAAG,aAAa,CAAC;YAC7B,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAEM,uCAAkB,GAAzB;QAAA,iBAmDC;QAlDS,IAAA,OAAO,GAAK,IAAI,CAAC,GAAG,QAAb,CAAc;QAE7B,IAAI,CAAC,cAAc,EAAE,CAAC;QAEtB,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAEtD,OAAO;YACL,cAAc,EAAE;gBACd,IAAI,KAAI,CAAC,UAAU,EAAE;oBACnB,OAAO,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;iBAC9B;gBACD,OAAO,iBAAiB,GAAG,OAAO,CAAC,iBAAiB,EAAE,CAAC,MAAM,CAAC;YAChE,CAAC;YAED,cAAc,EAAE,UAAC,MAAc;gBAC7B,IAAI,MAAM,IAAI,CAAC;oBAAE,OAAO,CAAC,CAAC;gBAC1B,IAAI,KAAI,CAAC,UAAU,EAAE;oBACnB,OAAO,KAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;iBAChC;gBACD,IAAI,WAAW,GAAG,CAAC,CAAC;gBACpB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,MAAM,EAAE,KAAK,EAAE,EAAE;oBAC3C,WAAW,IAAI,iBAAiB,CAAC;iBAClC;gBACD,OAAO,WAAW,CAAC;YACrB,CAAC;YAED,cAAc,EAAE;gBACd,OAAO,OAAO,CAAC,iBAAiB,EAAE,CAAC,MAAM,CAAC;YAC5C,CAAC;YAED,aAAa,EAAE,UAAC,SAAiB,EAAE,SAAiB;gBAClD,IAAI,KAAI,CAAC,UAAU,EAAE;oBACnB,OAAO,wBAAwB,CAC7B,KAAI,CAAC,UAAU,EACf,SAAS,EACT,SAAS,CACV,CAAC;iBACH;gBACD,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,iBAAiB,CAAC,CAAC;gBACvD,kBAAkB;gBAClB,IAAM,IAAI,GACR,SAAS,GAAG,iBAAiB,KAAK,CAAC;oBACjC,CAAC,CAAC,SAAS,GAAG,iBAAiB,GAAG,CAAC;oBACnC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,iBAAiB,CAAC,CAAC;gBAChD,OAAO;oBACL,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC;oBACxB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC;iBACvB,CAAC;YACJ,CAAC;SACF,CAAC;IACJ,CAAC;IA8TM,yBAAI,GAAX;QACE,iBAAM,IAAI,WAAE,CAAC;QACP,IAAA,KAAoB,IAAI,CAAC,SAAS,EAAhC,KAAK,WAAA,EAAE,MAAM,YAAmB,CAAC;QACzC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,OAAO,CAAC;YAClC,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE;gBACL,CAAC,EAAE,CAAC;gBACJ,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM;gBACzB,KAAK,OAAA;gBACL,MAAM,QAAA;aACP;SACF,CAAC,CAAC;IACL,CAAC;IAES,iCAAY,GAAtB;QACE,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YAChB,IAAA,KAA8C,IAAI,CAAC,SAAS,EAA1D,CAAC,OAAA,EAAE,KAAK,WAAA,EAAE,cAAc,oBAAA,EAAE,aAAa,mBAAmB,CAAC;YACnE,OAAO,IAAI,cAAc,CAAC;gBACxB,KAAK,OAAA;gBACL,MAAM,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM;gBAC9B,aAAa,eAAA;gBACb,cAAc,gBAAA;gBACd,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK;gBAClC,QAAQ,EAAE,EAAE,CAAC,GAAA,EAAE,CAAC,EAAE,CAAC,EAAE;gBACrB,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,QAAQ;gBAChC,uBAAuB,EACrB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,yBAAyB,EAAE;gBAClD,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC;gBACtD,WAAW,EAAE,IAAI,CAAC,WAAW;aAC9B,CAAC,CAAC;SACJ;QACD,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAES,wCAAmB,GAA7B;QACQ,IAAA,KAA+B,IAAI,CAAC,WAAW,EAA7C,eAAe,qBAAA,EAAE,OAAO,aAAqB,CAAC;QACtD,IAAM,MAAM,GAAG,GAAG,CAAC,OAAO,EAAE,oBAAoB,CAAC,CAAC;QAElD,IAAM,gBAAgB,GAAG,SAAS,CAAC,MAAM,CAAC;YACxC,CAAC,CAAC,MAAM;YACR,CAAC,CAAE,MAA8B,aAA9B,MAAM,uBAAN,MAAM,CAA0B,eAAe,CAAC;QACrD,IAAI,CAAC,gBAAgB,EAAE;YACrB,OAAO;SACR;QAED,IAAM,cAAc,GAAG,eAAe,CAAC,QAAQ,CAAC,yBAAyB,CAAC,CAAC;QAC3E,IAAM,oBAAoB,GAAG,eAAe,CAAC,QAAQ,CACnD,gCAAgC,CACjC,CAAC;QACF,IAAI,cAAc,EAAE;YAClB,cAAc,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;SACpC;QACD,IAAI,oBAAoB,EAAE;YACxB,oBAAoB,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;SAC1C;QACD,IAAM,QAAQ,GAAmB,gBAAgB,CAC/C,IAAI,CAAC,UAAU,CAAC,WAAW,EAAgB,EAC3C,YAAY,CACb,CAAC;QAEF,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAI;YACpB,IAAI,CAAC,cAAc,EAAE,CAAC;QACxB,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,2BAAM,GAAb;QACE,IAAI,CAAC,wBAAwB,EAAE,CAAC;QAChC,IAAI,CAAC,4BAA4B,EAAE,CAAC;QACpC,iBAAM,MAAM,WAAE,CAAC;QACf,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACjC,CAAC;IAaM,6CAAwB,GAA/B;QACQ,IAAA,KAKF,IAAI,CAAC,gBAAgB,EAAE,EAJzB,cAAc,oBAAA,EACd,cAAc,oBAAA,EACd,sBAAsB,4BAAA,EACtB,sBAAsB,4BACG,CAAC;QAE5B,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC;QACpD,IAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAC7C,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;QAChC,IAAA,KAAyC,IAAI,CAAC,eAAe,EAA3D,GAAG,SAAA,EAAE,GAAG,SAAA,EAAE,WAAW,iBAAA,EAAE,WAAW,iBAAyB,CAAC;QAEpE,IAAI,cAAc,GAAG,CAAC,EAAE;YACtB,GAAG,CAAC,KAAK;gBACP,YAAY,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,CAAC;oBAClC,YAAY,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,KAAK;oBACtC,CAAC,CAAC;YACJ,GAAG,CAAC,KAAK,GAAG,CAAC,CAAC,EAAE,cAAc,GAAG,CAAC,CAAC,CAAC;SACrC;QAED,IAAI,cAAc,GAAG,CAAC,EAAE;YACtB,GAAG,CAAC,MAAM;gBACR,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,KAAK,GAAG,cAAc,CAAC;oBAChE,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAClD,GAAG,CAAC,KAAK,GAAG,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,cAAc,CAAC,CAAC;SACjE;QAED,IAAI,sBAAsB,GAAG,CAAC,EAAE;YAC9B,WAAW,CAAC,KAAK;gBACf,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;oBACvC,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,sBAAsB,CAAC,CAAC,CAAC;oBAC5D,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC;YAC9C,WAAW,CAAC,KAAK,GAAG;gBAClB,YAAY,CAAC,MAAM,GAAG,sBAAsB;gBAC5C,YAAY,CAAC,MAAM,GAAG,CAAC;aACxB,CAAC;SACH;QAED,IAAI,sBAAsB,GAAG,CAAC,EAAE;YAC9B,WAAW,CAAC,MAAM;gBAChB,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,CAAC;oBACjD,eAAe,CAAC,cAAc,CAC5B,SAAS,CAAC,GAAG,GAAG,CAAC,GAAG,sBAAsB,CAC3C,CAAC;YACJ,WAAW,CAAC,KAAK,GAAG;gBAClB,SAAS,CAAC,GAAG,GAAG,sBAAsB;gBACtC,SAAS,CAAC,GAAG;aACd,CAAC;SACH;IACH,CAAC;IAES,iCAAY,GAAtB;QACE,OAAO,IAAI,CAAC;IACd,CAAC;IAES,0CAAqB,GAA/B;QACE,OAAO,IAAI,CAAC;IACd,CAAC;IAES,2CAAsB,GAAhC,UACE,OAAe,EACf,OAAe,EACf,UAAkB;QAElB,eAAe,CACb,IAAI,CAAC,WAAW,CAAC,cAAc,EAC/B,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,OAAO,CAChC,CAAC;QACF,eAAe,CACb,IAAI,CAAC,WAAW,CAAC,sBAAsB,EACvC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,OAAO,CAChC,CAAC;QACF,eAAe,CACb,IAAI,CAAC,WAAW,CAAC,cAAc,EAC/B,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,OAAO,CACjC,CAAC;QACF,eAAe,CACb,IAAI,CAAC,WAAW,CAAC,sBAAsB,EACvC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,OAAO,CACjC,CAAC;QAEF,iBAAM,sBAAsB,YAAC,OAAO,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;QAC3D,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,0BAA0B,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;IACpD,CAAC;IAEM,uCAAkB,GAAzB,UAA0B,OAAe,EAAE,OAAe;QACxD,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,CAAC;QACxD,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;QAEhC,IAAA,KAAmD,IAAI,CAAC,SAAS,EAA/C,MAAM,oBAAA,EAAiB,KAAK,mBAAmB,CAAC;QAElE,IAAA,KAKF,IAAI,CAAC,gBAAgB,EAAE,EAJzB,cAAc,oBAAA,EACd,cAAc,oBAAA,EACd,sBAAsB,4BAAA,EACtB,sBAAsB,4BACG,CAAC;QAE5B,IAAM,aAAa,GAAG;YACpB,KAAK,OAAA;YACL,MAAM,QAAA;YACN,CAAC,EAAE,CAAC;YACJ,CAAC,EAAE,CAAC;SACL,CAAC;QAEF,IAAI,sBAAsB,GAAG,CAAC,IAAI,cAAc,GAAG,CAAC,EAAE;YAC9C,IAAA,KAAuB,IAAI,CAAC,eAAe,EAAzC,WAAW,iBAAA,EAAE,GAAG,SAAyB,CAAC;YAClD,aAAa,CAAC,KAAK,IAAI,WAAW,CAAC,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;YACrD,aAAa,CAAC,CAAC,IAAI,GAAG,CAAC,KAAK,CAAC;SAC9B;QAED,IAAI,sBAAsB,GAAG,CAAC,IAAI,cAAc,GAAG,CAAC,EAAE;YAC9C,IAAA,KAAuB,IAAI,CAAC,eAAe,EAAzC,GAAG,SAAA,EAAE,WAAW,iBAAyB,CAAC;YAElD,aAAa,CAAC,MAAM,IAAI,GAAG,CAAC,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;YACxD,aAAa,CAAC,CAAC,IAAI,GAAG,CAAC,MAAM,CAAC;SAC/B;QAED,IAAM,OAAO,GAAG,sBAAsB,CACpC,OAAO,EACP,OAAO,EACP,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,eAAe,EACpB,aAAa,EACb,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAC3C,CAAC;QAEF,IAAI,CAAC,uBAAuB,GAAG,OAAO,CAAC;QAEvC,OAAO,4BAA4B,CACjC,OAAO,EACP;YACE,cAAc,gBAAA;YACd,cAAc,gBAAA;YACd,sBAAsB,wBAAA;YACtB,sBAAsB,wBAAA;SACvB,EACD,SAAS,EACT,SAAS,CACV,CAAC;IACJ,CAAC;IAED,qEAAqE;IAC3D,yBAAI,GAAd,UAAe,OAAe,EAAE,OAAe;;QAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC;QACpD,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAChD,IAAA,KAMF,IAAI,CAAC,WAAW,EALlB,cAAc,oBAAA,EACd,cAAc,oBAAA,EACd,sBAAsB,4BAAA,EACtB,sBAAsB,4BAAA,EACtB,gBAAgB,sBACE,CAAC;QACrB,IAAM,mBAAmB,GAAG,cAAc,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC;QAC3D,IAAM,oBAAoB,GAAG,cAAc,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC;QAC7D,IAAM,qBAAqB,GAAG,sBAAsB,CAAC,OAAO,EAAE,CAAC;QAC/D,IAAM,4BAA4B,GAChC,sBAAsB,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC;QAC1C,IAAM,qBAAqB,GACzB,IAAI,CAAC,SAAS,CAAC,KAAK;YACpB,mBAAmB;YACnB,sBAAsB,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC;QACzC,IAAM,sBAAsB,GAC1B,IAAI,CAAC,SAAS,CAAC,MAAM;YACrB,oBAAoB;YACpB,4BAA4B,CAAC;QAE/B,gBAAgB,CAAC,OAAO,CAAC;YACvB,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE;gBACL,CAAC,EAAE,OAAO,GAAG,mBAAmB;gBAChC,CAAC,EAAE,OAAO,GAAG,oBAAoB;gBACjC,KAAK,EAAE,qBAAqB;gBAC5B,MAAM,EAAE,sBAAsB;aAC/B;SACF,CAAC,CAAC;QAEH,cAAc,CAAC,OAAO,CAAC;YACrB,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE;gBACL,CAAC,EAAE,OAAO,GAAG,mBAAmB;gBAChC,CAAC,EAAE,iBAAiB;gBACpB,KAAK,EAAE,qBAAqB;gBAC5B,MAAM,EAAE,oBAAoB;aAC7B;SACF,CAAC,CAAC;QAEH,sBAAsB,CAAC,OAAO,CAAC;YAC7B,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE;gBACL,CAAC,EAAE,OAAO,GAAG,mBAAmB;gBAChC,CAAC,EAAE,sBAAsB,CAAC,OAAO,EAAE,CAAC,IAAI;gBACxC,KAAK,EAAE,qBAAqB;gBAC5B,MAAM,EAAE,4BAA4B;aACrC;SACF,CAAC,CAAC;QAEH,cAAc,CAAC,OAAO,CAAC;YACrB,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE;gBACL,CAAC,EAAE,CAAC;gBACJ,CAAC,EAAE,OAAO,GAAG,oBAAoB;gBACjC,KAAK,EAAE,mBAAmB;gBAC1B,MAAM,EAAE,sBAAsB;aAC/B;SACF,CAAC,CAAC;QAEH,sBAAsB,CAAC,OAAO,CAAC;YAC7B,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE;gBACL,CAAC,EAAE,qBAAqB,CAAC,IAAI;gBAC7B,CAAC,EAAE,OAAO,GAAG,oBAAoB;gBACjC,KAAK,EAAE,qBAAqB,CAAC,KAAK;gBAClC,MAAM,EAAE,sBAAsB;aAC/B;SACF,CAAC,CAAC;QAEH,IAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,QAAQ,CAC9D,yBAAyB,CAC1B,CAAC;QAEF,IAAI,cAAc,EAAE;YAClB,cAAc,CAAC,OAAO,CAAC;gBACrB,IAAI,EAAE,MAAM;gBACZ,KAAK,EAAE;oBACL,CAAC,EAAE,CAAC;oBACJ,CAAC,EAAE,oBAAoB,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM;oBAChD,KAAK,EAAE,MAAA,MAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAG,CAAC,CAAC,0CAAE,KAAK,mCAAI,CAAC;oBACpC,MAAM,EAAE,sBAAsB;iBAC/B;aACF,CAAC,CAAC;SACJ;IACH,CAAC;IACH,iBAAC;AAAD,CAAC,AAzjCD,CAAgC,SAAS,GAyjCxC\"}","dts":{"name":"F:/Ismart/S2-master/packages/s2-core/node_modules/.cache/rollup-plugin-typescript2/placeholder/facet/table-facet.d.ts","writeByteOrderMark":false,"text":"import type { IGroup } from '@antv/g-canvas';\r\nimport { ColHeader } from \"./header/col\";\r\nimport { SeriesNumberHeader } from './header';\r\nimport type { LayoutResult, S2CellType, SpreadSheetFacetCfg, ViewMeta } from \"../common/interface\";\r\nimport { BaseFacet } from \"./base-facet\";\r\nimport { PanelIndexes } from \"../utils/indexes\";\r\nexport declare class TableFacet extends BaseFacet {\r\n    rowOffsets: number[];\r\n    frozenGroupInfo: Record<string, {\r\n        width?: number;\r\n        height?: number;\r\n        range?: number[];\r\n    }>;\r\n    panelScrollGroupIndexes: any[];\r\n    constructor(cfg: SpreadSheetFacetCfg);\r\n    get dataCellTheme(): import(\"../common/interface\").CellTheme;\r\n    protected calculateCornerBBox(): void;\r\n    destroy(): void;\r\n    protected doLayout(): LayoutResult;\r\n    private getAdaptiveColWidth;\r\n    private getColNodeHeight;\r\n    private calculateColNodesCoordinate;\r\n    private calculateColLeafNodesWidth;\r\n    protected getDefaultCellHeight(): number;\r\n    getCellHeight(index: number): any;\r\n    protected initRowOffsets(): void;\r\n    getViewCellHeights(): {\r\n        getTotalHeight: () => number;\r\n        getCellOffsetY: (offset: number) => number;\r\n        getTotalLength: () => number;\r\n        getIndexRange: (minHeight: number, maxHeight: number) => {\r\n            start: number;\r\n            end: number;\r\n        };\r\n    };\r\n    protected initFrozenGroupPosition: () => void;\r\n    getTotalHeightForRange: (start: number, end: number) => number;\r\n    private getShadowFill;\r\n    protected renderFrozenGroupSplitLine: (scrollX: number, scrollY: number) => void;\r\n    protected renderFrozenPanelCornerGroup: () => void;\r\n    addFrozenCell: (colIndex: number, rowIndex: number, group: IGroup) => void;\r\n    addCell: (cell: S2CellType<ViewMeta>) => void;\r\n    init(): void;\r\n    protected getColHeader(): ColHeader;\r\n    protected updateRowResizeArea(): void;\r\n    render(): void;\r\n    private getFrozenOptions;\r\n    calculateFrozenGroupInfo(): void;\r\n    protected getRowHeader(): any;\r\n    protected getSeriesNumberHeader(): SeriesNumberHeader;\r\n    protected translateRelatedGroups(scrollX: number, scrollY: number, hRowScroll: number): void;\r\n    calculateXYIndexes(scrollX: number, scrollY: number): PanelIndexes;\r\n    protected clip(scrollX: number, scrollY: number): void;\r\n}\r\n"}}
