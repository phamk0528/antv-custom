{"code":"import { __extends } from \"tslib\";\r\nimport { BaseBBox } from './baseBBox';\r\nimport { CORNER_MAX_WIDTH_RATIO } from \"../../common/constant\";\r\nvar CornerBBox = /** @class */ (function (_super) {\r\n    __extends(CornerBBox, _super);\r\n    function CornerBBox() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CornerBBox.prototype.calculateBBox = function () {\r\n        var width = this.getCornerBBoxWidth();\r\n        var height = this.getCornerBBoxHeight();\r\n        this.width = width;\r\n        this.height = height;\r\n        this.maxX = width;\r\n        this.maxY = height;\r\n    };\r\n    CornerBBox.prototype.getCornerBBoxHeight = function () {\r\n        var colsHierarchy = this.layoutResult.colsHierarchy;\r\n        this.originalHeight = Math.floor(colsHierarchy.height);\r\n        return this.originalHeight;\r\n    };\r\n    CornerBBox.prototype.getCornerBBoxWidth = function () {\r\n        var rowsHierarchy = this.layoutResult.rowsHierarchy;\r\n        this.originalWidth = Math.floor(rowsHierarchy.width + this.facet.getSeriesNumberWidth());\r\n        // 在行头不固定时，无需对角头 BBox 进行裁剪\r\n        if (this.spreadsheet.isScrollContainsRowHeader()) {\r\n            return this.originalWidth;\r\n        }\r\n        return this.adjustCornerBBoxWidth();\r\n    };\r\n    CornerBBox.prototype.adjustCornerBBoxWidth = function () {\r\n        var colsHierarchy = this.layoutResult.colsHierarchy;\r\n        var canvasWidth = this.spreadsheet.options.width;\r\n        var maxCornerBBoxWidth = canvasWidth * CORNER_MAX_WIDTH_RATIO;\r\n        var colsHierarchyWidth = colsHierarchy === null || colsHierarchy === void 0 ? void 0 : colsHierarchy.width;\r\n        var panelWidthWidthUnClippedCorner = canvasWidth - this.originalWidth;\r\n        // 不需要裁剪条件：\r\n        // 1. 角头的宽度没有超过最大的角头范围\r\n        // 2. 列头的宽度没有超过在不裁剪角头前提下的剩余范围\r\n        if (this.originalWidth <= maxCornerBBoxWidth ||\r\n            colsHierarchyWidth <= panelWidthWidthUnClippedCorner) {\r\n            return this.originalWidth;\r\n        }\r\n        var clippedWidth = 0;\r\n        var maxPanelWidth = canvasWidth - maxCornerBBoxWidth;\r\n        // 列头宽度超过了剩余宽度，但是小于 Panel 的最大宽度\r\n        if (colsHierarchyWidth <= maxPanelWidth) {\r\n            clippedWidth =\r\n                this.originalWidth -\r\n                    (colsHierarchyWidth - panelWidthWidthUnClippedCorner);\r\n        }\r\n        else {\r\n            clippedWidth = maxCornerBBoxWidth;\r\n        }\r\n        return Math.floor(clippedWidth);\r\n    };\r\n    return CornerBBox;\r\n}(BaseBBox));\r\nexport { CornerBBox };\r\n//# sourceMappingURL=cornerBBox.js.map","references":["F:/Ismart/S2-master/packages/s2-core/src/facet/bbox/baseBBox.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/index.ts"],"map":"{\"version\":3,\"file\":\"cornerBBox.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/facet/bbox/cornerBBox.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AACtC,OAAO,EAAE,sBAAsB,EAAE,8BAA0B;AAE3D;IAAgC,8BAAQ;IAAxC;;IAgEA,CAAC;IA/DC,kCAAa,GAAb;QACE,IAAM,KAAK,GAAG,IAAI,CAAC,kBAAkB,EAAE,CAAC;QACxC,IAAM,MAAM,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAE1C,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;QAClB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;IACrB,CAAC;IAEO,wCAAmB,GAA3B;QACU,IAAA,aAAa,GAAK,IAAI,CAAC,YAAY,cAAtB,CAAuB;QAC5C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAEvD,OAAO,IAAI,CAAC,cAAc,CAAC;IAC7B,CAAC;IAEO,uCAAkB,GAA1B;QACU,IAAA,aAAa,GAAK,IAAI,CAAC,YAAY,cAAtB,CAAuB;QAC5C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAC7B,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,oBAAoB,EAAE,CACxD,CAAC;QAEF,0BAA0B;QAC1B,IAAI,IAAI,CAAC,WAAW,CAAC,yBAAyB,EAAE,EAAE;YAChD,OAAO,IAAI,CAAC,aAAa,CAAC;SAC3B;QAED,OAAO,IAAI,CAAC,qBAAqB,EAAE,CAAC;IACtC,CAAC;IAEO,0CAAqB,GAA7B;QACU,IAAA,aAAa,GAAK,IAAI,CAAC,YAAY,cAAtB,CAAuB;QACpC,IAAO,WAAW,GAAK,IAAI,CAAC,WAAW,CAAC,OAAO,MAA7B,CAA8B;QAExD,IAAM,kBAAkB,GAAG,WAAW,GAAG,sBAAsB,CAAC;QAChE,IAAM,kBAAkB,GAAG,aAAa,aAAb,aAAa,uBAAb,aAAa,CAAE,KAAK,CAAC;QAChD,IAAM,8BAA8B,GAAG,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC;QAExE,WAAW;QACX,sBAAsB;QACtB,6BAA6B;QAC7B,IACE,IAAI,CAAC,aAAa,IAAI,kBAAkB;YACxC,kBAAkB,IAAI,8BAA8B,EACpD;YACA,OAAO,IAAI,CAAC,aAAa,CAAC;SAC3B;QAED,IAAI,YAAY,GAAG,CAAC,CAAC;QACrB,IAAM,aAAa,GAAG,WAAW,GAAG,kBAAkB,CAAC;QAEvD,+BAA+B;QAC/B,IAAI,kBAAkB,IAAI,aAAa,EAAE;YACvC,YAAY;gBACV,IAAI,CAAC,aAAa;oBAClB,CAAC,kBAAkB,GAAG,8BAA8B,CAAC,CAAC;SACzD;aAAM;YACL,YAAY,GAAG,kBAAkB,CAAC;SACnC;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;IAClC,CAAC;IACH,iBAAC;AAAD,CAAC,AAhED,CAAgC,QAAQ,GAgEvC\"}","dts":{"name":"F:/Ismart/S2-master/packages/s2-core/node_modules/.cache/rollup-plugin-typescript2/placeholder/facet/bbox/cornerBBox.d.ts","writeByteOrderMark":false,"text":"import { BaseBBox } from './baseBBox';\r\nexport declare class CornerBBox extends BaseBBox {\r\n    calculateBBox(): void;\r\n    private getCornerBBoxHeight;\r\n    private getCornerBBoxWidth;\r\n    private adjustCornerBBoxWidth;\r\n}\r\n"}}
