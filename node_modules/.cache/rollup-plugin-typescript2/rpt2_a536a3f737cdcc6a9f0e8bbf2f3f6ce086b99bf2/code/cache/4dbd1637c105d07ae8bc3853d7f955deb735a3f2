{"code":"import { __extends } from \"tslib\";\r\nimport { each, isEmpty } from 'lodash';\r\nimport { RowCell } from '../../cell';\r\nimport { translateGroup } from '../utils';\r\nimport { BaseHeader } from './base';\r\n/**\r\n * Row Header for SpreadSheet\r\n */\r\nvar RowHeader = /** @class */ (function (_super) {\r\n    __extends(RowHeader, _super);\r\n    function RowHeader(cfg) {\r\n        return _super.call(this, cfg) || this;\r\n    }\r\n    RowHeader.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        if (this.gm) {\r\n            this.gm.destroy();\r\n        }\r\n    };\r\n    RowHeader.prototype.layout = function () {\r\n        var _this = this;\r\n        var _a, _b;\r\n        var _c = this.headerConfig, data = _c.data, spreadsheet = _c.spreadsheet, width = _c.width, viewportHeight = _c.viewportHeight, seriesNumberWidth = _c.seriesNumberWidth, scrollY = _c.scrollY, scrollX = _c.scrollX;\r\n        var rowCell = (_b = (_a = spreadsheet === null || spreadsheet === void 0 ? void 0 : spreadsheet.facet) === null || _a === void 0 ? void 0 : _a.cfg) === null || _b === void 0 ? void 0 : _b.rowCell;\r\n        // row'cell only show when visible\r\n        var rowCellInRect = function (item) {\r\n            return (viewportHeight + scrollY > item.y && // bottom\r\n                scrollY < item.y + item.height && // top\r\n                width - seriesNumberWidth + scrollX > item.x && // left\r\n                scrollX - seriesNumberWidth < item.x + item.width); // right\r\n        };\r\n        each(data, function (item) {\r\n            if (rowCellInRect(item) && item.height !== 0) {\r\n                var cell = void 0;\r\n                // 首先由外部控制UI展示\r\n                if (rowCell) {\r\n                    cell = rowCell(item, spreadsheet, _this.headerConfig);\r\n                }\r\n                // 如果外部没处理，就用默认的\r\n                if (isEmpty(cell)) {\r\n                    if (spreadsheet.isPivotMode()) {\r\n                        cell = new RowCell(item, spreadsheet, _this.headerConfig);\r\n                    }\r\n                }\r\n                item.belongsCell = cell;\r\n                _this.add(cell);\r\n            }\r\n        });\r\n    };\r\n    RowHeader.prototype.offset = function () {\r\n        var _a = this.headerConfig, scrollX = _a.scrollX, scrollY = _a.scrollY, position = _a.position, seriesNumberWidth = _a.seriesNumberWidth;\r\n        // 向右多移动的seriesNumberWidth是序号的宽度\r\n        translateGroup(this, position.x - scrollX + seriesNumberWidth, position.y - scrollY);\r\n    };\r\n    RowHeader.prototype.clip = function () {\r\n        var _a = this.headerConfig, width = _a.width, viewportHeight = _a.viewportHeight, scrollX = _a.scrollX, scrollY = _a.scrollY, seriesNumberWidth = _a.seriesNumberWidth;\r\n        this.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                // 由于多移动了seriesNumberWidth跨度，所有需要向左切。 - 是反向剪裁（右 -> 左）\r\n                x: scrollX - seriesNumberWidth,\r\n                y: scrollY,\r\n                width: width,\r\n                height: viewportHeight,\r\n            },\r\n        });\r\n    };\r\n    return RowHeader;\r\n}(BaseHeader));\r\nexport { RowHeader };\r\n//# sourceMappingURL=row.js.map","references":["F:/Ismart/S2-master/node_modules/@antv/g-gesture/lib/index.d.ts","F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/cell/index.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/utils.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/header/base.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/node.ts"],"map":"{\"version\":3,\"file\":\"row.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/facet/header/row.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"F:/Ismart/S2-master/packages/s2-core/node_modules/.cache/rollup-plugin-typescript2/placeholder/facet/header/row.d.ts","writeByteOrderMark":false,"text":"import { S2Options } from '../../common/interface';\r\nimport { BaseHeader, BaseHeaderConfig } from './base';\r\nexport interface RowHeaderConfig extends BaseHeaderConfig {\r\n    hierarchyType: S2Options['hierarchyType'];\r\n    linkFields: string[];\r\n    seriesNumberWidth: number;\r\n}\r\n/**\r\n * Row Header for SpreadSheet\r\n */\r\nexport declare class RowHeader extends BaseHeader<RowHeaderConfig> {\r\n    private gm;\r\n    constructor(cfg: RowHeaderConfig);\r\n    destroy(): void;\r\n    protected layout(): void;\r\n    protected offset(): void;\r\n    protected clip(): void;\r\n}\r\n"}}
