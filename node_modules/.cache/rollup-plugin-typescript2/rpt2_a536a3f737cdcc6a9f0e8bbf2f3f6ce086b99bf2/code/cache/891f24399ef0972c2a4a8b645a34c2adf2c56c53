{"code":"import { __assign, __extends, __read, __spreadArray } from \"tslib\";\r\nimport { SpreadSheet } from './spread-sheet';\r\nimport { TableDataCell, TableRowCell } from \"../cell\";\r\nimport { InterceptType, KEY_GROUP_PANEL_FROZEN_BOTTOM, KEY_GROUP_PANEL_FROZEN_COL, KEY_GROUP_PANEL_FROZEN_ROW, KEY_GROUP_PANEL_FROZEN_TOP, KEY_GROUP_PANEL_FROZEN_TRAILING_COL, KEY_GROUP_PANEL_FROZEN_TRAILING_ROW, PANEL_GROUP_FROZEN_GROUP_Z_INDEX, S2Event, TOOLTIP_OPERATOR_TABLE_SORT_MENUS, } from \"../common/constant\";\r\nimport { TableDataSet } from \"../data-set\";\r\nimport { TableFacet } from \"../facet\";\r\nvar TableSheet = /** @class */ (function (_super) {\r\n    __extends(TableSheet, _super);\r\n    function TableSheet() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onSortTooltipClick = function (_a, meta) {\r\n            var key = _a.key;\r\n            var field = meta.field;\r\n            var prevOtherSortParams = [];\r\n            var prevSelectedSortParams;\r\n            _this.dataCfg.sortParams.forEach(function (item) {\r\n                if ((item === null || item === void 0 ? void 0 : item.sortFieldId) !== field) {\r\n                    prevOtherSortParams.push(item);\r\n                }\r\n                else {\r\n                    prevSelectedSortParams = item;\r\n                }\r\n            });\r\n            var sortParam = __assign(__assign({}, (prevSelectedSortParams || {})), { sortFieldId: field, sortMethod: key });\r\n            // 触发排序事件\r\n            _this.emit(S2Event.RANGE_SORT, __spreadArray(__spreadArray([], __read(prevOtherSortParams), false), [sortParam], false));\r\n        };\r\n        return _this;\r\n    }\r\n    TableSheet.prototype.getDataSet = function (options) {\r\n        var dataSet = options.dataSet;\r\n        if (dataSet) {\r\n            return dataSet(this);\r\n        }\r\n        return new TableDataSet(this);\r\n    };\r\n    /**\r\n     * Check if is pivot mode\r\n     */\r\n    TableSheet.prototype.isPivotMode = function () {\r\n        return false;\r\n    };\r\n    /**\r\n     * Check if is pivot mode\r\n     */\r\n    TableSheet.prototype.isTableMode = function () {\r\n        return true;\r\n    };\r\n    /**\r\n     * tree type must be in strategy mode\r\n     */\r\n    TableSheet.prototype.isHierarchyTreeType = function () {\r\n        return false;\r\n    };\r\n    /**\r\n     * Check whether scroll contains row header\r\n     * For now contains row header in ListSheet mode by default\r\n     */\r\n    TableSheet.prototype.isScrollContainsRowHeader = function () {\r\n        return false;\r\n    };\r\n    /**\r\n     * Scroll Freeze Row Header\r\n     */\r\n    TableSheet.prototype.isFrozenRowHeader = function () {\r\n        return false;\r\n    };\r\n    TableSheet.prototype.clearDrillDownData = function () { };\r\n    /**\r\n     * Check if the value is in the columns\r\n     */\r\n    TableSheet.prototype.isValueInCols = function () {\r\n        return false;\r\n    };\r\n    TableSheet.prototype.bindEvents = function () { };\r\n    TableSheet.prototype.initPanelGroupChildren = function () {\r\n        _super.prototype.initPanelGroupChildren.call(this);\r\n        this.frozenRowGroup = this.panelGroup.addGroup({\r\n            name: KEY_GROUP_PANEL_FROZEN_ROW,\r\n            zIndex: PANEL_GROUP_FROZEN_GROUP_Z_INDEX,\r\n        });\r\n        this.frozenColGroup = this.panelGroup.addGroup({\r\n            name: KEY_GROUP_PANEL_FROZEN_COL,\r\n            zIndex: PANEL_GROUP_FROZEN_GROUP_Z_INDEX,\r\n        });\r\n        this.frozenTrailingRowGroup = this.panelGroup.addGroup({\r\n            name: KEY_GROUP_PANEL_FROZEN_TRAILING_ROW,\r\n            zIndex: PANEL_GROUP_FROZEN_GROUP_Z_INDEX,\r\n        });\r\n        this.frozenTrailingColGroup = this.panelGroup.addGroup({\r\n            name: KEY_GROUP_PANEL_FROZEN_TRAILING_COL,\r\n            zIndex: PANEL_GROUP_FROZEN_GROUP_Z_INDEX,\r\n        });\r\n        this.frozenTopGroup = this.panelGroup.addGroup({\r\n            name: KEY_GROUP_PANEL_FROZEN_TOP,\r\n            zIndex: PANEL_GROUP_FROZEN_GROUP_Z_INDEX,\r\n        });\r\n        this.frozenBottomGroup = this.panelGroup.addGroup({\r\n            name: KEY_GROUP_PANEL_FROZEN_BOTTOM,\r\n            zIndex: PANEL_GROUP_FROZEN_GROUP_Z_INDEX,\r\n        });\r\n    };\r\n    TableSheet.prototype.getFacetCfgFromDataSetAndOptions = function () {\r\n        var _this = this;\r\n        var _a = this.dataSet, fields = _a.fields, meta = _a.meta;\r\n        var _b = this.options, style = _b.style, dataCell = _b.dataCell;\r\n        // 默认单元格实现\r\n        var defaultCell = function (facet) {\r\n            if (_this.options.showSeriesNumber && facet.colIndex === 0) {\r\n                return new TableRowCell(facet, _this);\r\n            }\r\n            return new TableDataCell(facet, _this);\r\n        };\r\n        return __assign(__assign(__assign(__assign({}, fields), style), this.options), { meta: meta, spreadsheet: this, dataSet: this.dataSet, dataCell: dataCell !== null && dataCell !== void 0 ? dataCell : defaultCell });\r\n    };\r\n    TableSheet.prototype.buildFacet = function () {\r\n        var _a;\r\n        var facetCfg = this.getFacetCfgFromDataSetAndOptions();\r\n        (_a = this.facet) === null || _a === void 0 ? void 0 : _a.destroy();\r\n        this.facet = new TableFacet(facetCfg);\r\n        this.facet.render();\r\n    };\r\n    TableSheet.prototype.clearFrozenGroups = function () {\r\n        this.frozenRowGroup.set('children', []);\r\n        this.frozenColGroup.set('children', []);\r\n        this.frozenTrailingRowGroup.set('children', []);\r\n        this.frozenTrailingColGroup.set('children', []);\r\n        this.frozenTopGroup.set('children', []);\r\n        this.frozenBottomGroup.set('children', []);\r\n    };\r\n    TableSheet.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this.clearFrozenGroups();\r\n    };\r\n    TableSheet.prototype.handleGroupSort = function (event, meta) {\r\n        var _this = this;\r\n        event.stopPropagation();\r\n        this.interaction.addIntercepts([InterceptType.HOVER]);\r\n        var operator = {\r\n            onClick: function (params) {\r\n                return _this.onSortTooltipClick(params, meta);\r\n            },\r\n            menus: TOOLTIP_OPERATOR_TABLE_SORT_MENUS,\r\n        };\r\n        this.showTooltipWithInfo(event, [], {\r\n            operator: operator,\r\n            onlyMenu: true,\r\n        });\r\n    };\r\n    return TableSheet;\r\n}(SpreadSheet));\r\nexport { TableSheet };\r\n//# sourceMappingURL=table-sheet.js.map","references":["F:/Ismart/S2-master/packages/s2-core/src/facet/layout/node.ts","F:/Ismart/S2-master/node_modules/@antv/g-canvas/lib/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/sheet-type/spread-sheet.ts","F:/Ismart/S2-master/packages/s2-core/src/cell/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts","F:/Ismart/S2-master/packages/s2-core/src/data-set/index.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/index.ts"],"map":"{\"version\":3,\"file\":\"table-sheet.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/sheet-type/table-sheet.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"F:/Ismart/S2-master/packages/s2-core/node_modules/.cache/rollup-plugin-typescript2/placeholder/sheet-type/table-sheet.d.ts","writeByteOrderMark":false,"text":"import { Node } from \"../facet/layout/node\";\r\nimport { Event as CanvasEvent } from '@antv/g-canvas';\r\nimport { SpreadSheet } from './spread-sheet';\r\nimport { S2Options, SpreadSheetFacetCfg } from \"../common/interface\";\r\nexport declare class TableSheet extends SpreadSheet {\r\n    getDataSet(options: S2Options): any;\r\n    /**\r\n     * Check if is pivot mode\r\n     */\r\n    isPivotMode(): boolean;\r\n    /**\r\n     * Check if is pivot mode\r\n     */\r\n    isTableMode(): boolean;\r\n    /**\r\n     * tree type must be in strategy mode\r\n     */\r\n    isHierarchyTreeType(): boolean;\r\n    /**\r\n     * Check whether scroll contains row header\r\n     * For now contains row header in ListSheet mode by default\r\n     */\r\n    isScrollContainsRowHeader(): boolean;\r\n    /**\r\n     * Scroll Freeze Row Header\r\n     */\r\n    isFrozenRowHeader(): boolean;\r\n    clearDrillDownData(): void;\r\n    /**\r\n     * Check if the value is in the columns\r\n     */\r\n    isValueInCols(): boolean;\r\n    protected bindEvents(): void;\r\n    protected initPanelGroupChildren(): void;\r\n    protected getFacetCfgFromDataSetAndOptions(): SpreadSheetFacetCfg;\r\n    protected buildFacet(): void;\r\n    protected clearFrozenGroups(): void;\r\n    destroy(): void;\r\n    onSortTooltipClick: ({ key }: {\r\n        key: any;\r\n    }, meta: any) => void;\r\n    handleGroupSort(event: CanvasEvent, meta: Node): void;\r\n}\r\n"}}
