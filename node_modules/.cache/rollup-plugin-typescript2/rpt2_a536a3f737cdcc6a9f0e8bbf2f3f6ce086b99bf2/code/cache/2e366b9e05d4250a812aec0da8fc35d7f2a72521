{"code":"import { __read, __spreadArray } from \"tslib\";\r\nimport { findIndex, isNil } from 'lodash';\r\nimport { FrozenCellType, } from \"../common/constant/frozen\";\r\nexport var isFrozenCol = function (colIndex, frozenCount) {\r\n    return frozenCount > 0 && colIndex < frozenCount;\r\n};\r\nexport var isFrozenTrailingCol = function (colIndex, frozenCount, colLength) {\r\n    return frozenCount > 0 && colIndex >= colLength - frozenCount;\r\n};\r\nexport var isFrozenRow = function (rowIndex, minRowIndex, frozenCount) {\r\n    return frozenCount > 0 && rowIndex < minRowIndex + frozenCount;\r\n};\r\nexport var isFrozenTrailingRow = function (rowIndex, maxRowIndex, frozenCount) {\r\n    return frozenCount > 0 && rowIndex >= maxRowIndex + 1 - frozenCount;\r\n};\r\n/**\r\n * 计算偏移 scrollX、scrollY 的时候，在视窗中的节点索引\r\n * @param scrollX\r\n * @param scrollY\r\n * @param widths\r\n * @param heights\r\n * @param viewport\r\n * @param rowRemainWidth\r\n */\r\nexport var calculateInViewIndexes = function (scrollX, scrollY, widths, heights, viewport, rowRemainWidth) {\r\n    // 1. 计算 x min、max\r\n    var xMin = findIndex(widths, function (width, idx) {\r\n        var x = scrollX - (isNil(rowRemainWidth) ? 0 : rowRemainWidth) + viewport.x;\r\n        return x >= width && x < widths[idx + 1];\r\n    }, 0);\r\n    xMin = Math.max(xMin, 0);\r\n    var xMax = findIndex(widths, function (width, idx) {\r\n        var x = viewport.width + scrollX + viewport.x;\r\n        return x >= width && x < widths[idx + 1];\r\n    }, xMin);\r\n    xMax = Math.min(xMax === -1 ? Infinity : xMax, widths.length - 2);\r\n    var _a = heights.getIndexRange(scrollY + viewport.y, viewport.height + scrollY + viewport.y), yMin = _a.start, yMax = _a.end;\r\n    // use direction\r\n    // const halfWidthSize = Math.ceil(xMax - xMin / 4);\r\n    // const halfHeightSize = Math.ceil(yMax - yMin / 4);\r\n    // xMin = Math.max(0, xMin - halfWidthSize)\r\n    // xMax = xMax + halfWidthSize;\r\n    // yMin = Math.max(0, yMin - halfHeightSize);\r\n    // yMax = yMax + halfHeightSize;\r\n    return [xMin, xMax, yMin, yMax];\r\n};\r\n/**\r\n * 优化滚动方向，对于小角度的滚动，固定为一个方向\r\n * @param x\r\n * @param y\r\n * @param ratio\r\n */\r\nexport var optimizeScrollXY = function (x, y, ratio) {\r\n    var ANGLE = 2; // 调参工程师\r\n    var angle = Math.abs(x / y);\r\n    // 经过滚动优化之后的 x, y\r\n    var deltaX = angle <= 1 / ANGLE ? 0 : x;\r\n    var deltaY = angle > ANGLE ? 0 : y;\r\n    return [deltaX * ratio.horizontal, deltaY * ratio.vertical];\r\n};\r\nexport var translateGroup = function (group, scrollX, scrollY) {\r\n    var _a, _b;\r\n    var matrix = group === null || group === void 0 ? void 0 : group.getMatrix();\r\n    var preX = (_a = matrix === null || matrix === void 0 ? void 0 : matrix[6]) !== null && _a !== void 0 ? _a : 0;\r\n    var preY = (_b = matrix === null || matrix === void 0 ? void 0 : matrix[7]) !== null && _b !== void 0 ? _b : 0;\r\n    group === null || group === void 0 ? void 0 : group.translate(scrollX - preX, scrollY - preY);\r\n};\r\nexport var translateGroupX = function (group, scrollX) {\r\n    var _a;\r\n    var matrix = group === null || group === void 0 ? void 0 : group.getMatrix();\r\n    var preX = (_a = matrix === null || matrix === void 0 ? void 0 : matrix[6]) !== null && _a !== void 0 ? _a : 0;\r\n    group === null || group === void 0 ? void 0 : group.translate(scrollX - preX, 0);\r\n};\r\nexport var translateGroupY = function (group, scrollY) {\r\n    var _a;\r\n    var matrix = group === null || group === void 0 ? void 0 : group.getMatrix();\r\n    var preY = (_a = matrix === null || matrix === void 0 ? void 0 : matrix[7]) !== null && _a !== void 0 ? _a : 0;\r\n    group === null || group === void 0 ? void 0 : group.translate(0, scrollY - preY);\r\n};\r\n/**\r\n * frozen                     frozenTrailing\r\n * ColCount                   ColCount\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * |     |     frozenRow     |          |  frozenRowCount\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * | fro |                   | fro      |\r\n * | zen |      panel        | zen      |\r\n * | col |      scroll       | trailing |\r\n * |     |                   | col      |\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * |     | frozenTrailingRow |          |  frozenTrailingRowCount\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * @description returns which group data cell belongs in frozen mode\r\n */\r\nexport var getFrozenDataCellType = function (meta, frozenOpts, colLength, cellRange) {\r\n    var frozenColCount = frozenOpts.frozenColCount, frozenRowCount = frozenOpts.frozenRowCount, frozenTrailingColCount = frozenOpts.frozenTrailingColCount, frozenTrailingRowCount = frozenOpts.frozenTrailingRowCount;\r\n    var colIndex = meta.colIndex, rowIndex = meta.rowIndex;\r\n    if (isFrozenRow(rowIndex, cellRange.start, frozenRowCount)) {\r\n        return FrozenCellType.ROW;\r\n    }\r\n    if (isFrozenTrailingRow(rowIndex, cellRange.end, frozenTrailingRowCount)) {\r\n        return FrozenCellType.TRAILING_ROW;\r\n    }\r\n    if (isFrozenCol(colIndex, frozenColCount)) {\r\n        return FrozenCellType.COL;\r\n    }\r\n    if (isFrozenTrailingCol(colIndex, frozenTrailingColCount, colLength)) {\r\n        return FrozenCellType.TRAILING_COL;\r\n    }\r\n    return FrozenCellType.SCROLL;\r\n};\r\n/**\r\n * @description calculate all cells in frozen group's intersection region\r\n */\r\nexport var calculateFrozenCornerCells = function (opts, colLength, cellRange) {\r\n    var _a;\r\n    var frozenColCount = opts.frozenColCount, frozenRowCount = opts.frozenRowCount, frozenTrailingColCount = opts.frozenTrailingColCount, frozenTrailingRowCount = opts.frozenTrailingRowCount;\r\n    var result = (_a = {},\r\n        _a[FrozenCellType.TOP] = [],\r\n        _a[FrozenCellType.BOTTOM] = [],\r\n        _a);\r\n    // frozenColGroup with frozenRowGroup or frozenTrailingRowGroup. Top left and bottom left corner.\r\n    for (var i = 0; i < frozenColCount; i++) {\r\n        for (var j = cellRange.start; j < cellRange.start + frozenRowCount; j++) {\r\n            result[FrozenCellType.TOP].push({\r\n                x: i,\r\n                y: j,\r\n            });\r\n        }\r\n        if (frozenTrailingRowCount > 0) {\r\n            for (var j = 0; j < frozenTrailingRowCount; j++) {\r\n                var index = cellRange.end - j;\r\n                result[FrozenCellType.BOTTOM].push({\r\n                    x: i,\r\n                    y: index,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    // frozenTrailingColGroup with frozenRowGroup or frozenTrailingRowGroup. Top right and bottom right corner.\r\n    for (var i = 0; i < frozenTrailingColCount; i++) {\r\n        var colIndex = colLength - 1 - i;\r\n        for (var j = cellRange.start; j < cellRange.start + frozenRowCount; j++) {\r\n            result[FrozenCellType.TOP].push({\r\n                x: colIndex,\r\n                y: j,\r\n            });\r\n        }\r\n        if (frozenTrailingRowCount > 0) {\r\n            for (var j = 0; j < frozenTrailingRowCount; j++) {\r\n                var index = cellRange.end - j;\r\n                result[FrozenCellType.BOTTOM].push({\r\n                    x: colIndex,\r\n                    y: index,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n};\r\nexport var isFrozenCell = function (colIndex, rowIndex, frozenOpts, colLength, cellRange) {\r\n    var frozenColCount = frozenOpts.frozenColCount, frozenRowCount = frozenOpts.frozenRowCount, frozenTrailingColCount = frozenOpts.frozenTrailingColCount, frozenTrailingRowCount = frozenOpts.frozenTrailingRowCount;\r\n    return (isFrozenCol(colIndex, frozenColCount) ||\r\n        isFrozenTrailingCol(colIndex, frozenTrailingColCount, colLength) ||\r\n        isFrozenRow(rowIndex, cellRange.start, frozenRowCount) ||\r\n        isFrozenTrailingRow(rowIndex, cellRange.end, frozenTrailingRowCount));\r\n};\r\n/**\r\n * @description split all cells in current panel with five child group\r\n */\r\nexport var splitInViewIndexesWithFrozen = function (indexes, frozenOpts, colLength, cellRange) {\r\n    var frozenColCount = frozenOpts.frozenColCount, frozenRowCount = frozenOpts.frozenRowCount, frozenTrailingColCount = frozenOpts.frozenTrailingColCount, frozenTrailingRowCount = frozenOpts.frozenTrailingRowCount;\r\n    var centerIndexes = __spreadArray([], __read(indexes), false);\r\n    // Cut off frozen cells from centerIndexes\r\n    if (isFrozenCol(centerIndexes[0], frozenColCount)) {\r\n        centerIndexes[0] = frozenColCount;\r\n    }\r\n    if (isFrozenTrailingCol(centerIndexes[1], frozenTrailingColCount, colLength)) {\r\n        centerIndexes[1] = colLength - frozenTrailingColCount - 1;\r\n    }\r\n    if (isFrozenRow(centerIndexes[2], cellRange.start, frozenRowCount)) {\r\n        centerIndexes[2] = cellRange.start + frozenRowCount;\r\n    }\r\n    if (isFrozenTrailingRow(centerIndexes[3], cellRange.end, frozenTrailingRowCount)) {\r\n        centerIndexes[3] = cellRange.end - frozenTrailingRowCount;\r\n    }\r\n    // Calculate indexes for four frozen groups\r\n    var frozenRowIndexes = __spreadArray([], __read(centerIndexes), false);\r\n    frozenRowIndexes[2] = cellRange.start;\r\n    frozenRowIndexes[3] = cellRange.start + frozenRowCount - 1;\r\n    var frozenColIndexes = __spreadArray([], __read(centerIndexes), false);\r\n    frozenColIndexes[0] = 0;\r\n    frozenColIndexes[1] = frozenColCount - 1;\r\n    var frozenTrailingRowIndexes = __spreadArray([], __read(centerIndexes), false);\r\n    frozenTrailingRowIndexes[2] = cellRange.end + 1 - frozenTrailingRowCount;\r\n    frozenTrailingRowIndexes[3] = cellRange.end;\r\n    var frozenTrailingColIndexes = __spreadArray([], __read(centerIndexes), false);\r\n    frozenTrailingColIndexes[0] = colLength - frozenTrailingColCount;\r\n    frozenTrailingColIndexes[1] = colLength - 1;\r\n    return {\r\n        center: centerIndexes,\r\n        frozenRow: frozenRowIndexes,\r\n        frozenCol: frozenColIndexes,\r\n        frozenTrailingCol: frozenTrailingColIndexes,\r\n        frozenTrailingRow: frozenTrailingRowIndexes,\r\n    };\r\n};\r\nexport var getCellRange = function (viewCellHeights, pagination) {\r\n    var heights = viewCellHeights;\r\n    var start = 0;\r\n    var end = heights.getTotalLength() - 1;\r\n    if (pagination) {\r\n        var current = pagination.current, pageSize = pagination.pageSize;\r\n        start = Math.max((current - 1) * pageSize, 0);\r\n        end = Math.min(current * pageSize - 1, heights.getTotalLength() - 1);\r\n    }\r\n    return {\r\n        start: start,\r\n        end: end,\r\n    };\r\n};\r\n//# sourceMappingURL=utils.js.map","references":["F:/Ismart/S2-master/node_modules/@antv/g-canvas/lib/index.d.ts","F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/indexes.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/interface.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/frozen.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts"],"map":"{\"version\":3,\"file\":\"utils.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/facet/utils.ts\"],\"names\":[],\"mappings\":\";AACA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,QAAQ,CAAC;AAI1C,OAAO,EACL,cAAc,GAGf,kCAAiC;AAGlC,MAAM,CAAC,IAAM,WAAW,GAAG,UAAC,QAAgB,EAAE,WAAmB;IAC/D,OAAO,WAAW,GAAG,CAAC,IAAI,QAAQ,GAAG,WAAW,CAAC;AACnD,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,mBAAmB,GAAG,UACjC,QAAgB,EAChB,WAAmB,EACnB,SAAiB;IAEjB,OAAO,WAAW,GAAG,CAAC,IAAI,QAAQ,IAAI,SAAS,GAAG,WAAW,CAAC;AAChE,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,WAAW,GAAG,UACzB,QAAgB,EAChB,WAAmB,EACnB,WAAmB;IAEnB,OAAO,WAAW,GAAG,CAAC,IAAI,QAAQ,GAAG,WAAW,GAAG,WAAW,CAAC;AACjE,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,mBAAmB,GAAG,UACjC,QAAgB,EAChB,WAAmB,EACnB,WAAmB;IAEnB,OAAO,WAAW,GAAG,CAAC,IAAI,QAAQ,IAAI,WAAW,GAAG,CAAC,GAAG,WAAW,CAAC;AACtE,CAAC,CAAC;AAEF;;;;;;;;GAQG;AACH,MAAM,CAAC,IAAM,sBAAsB,GAAG,UACpC,OAAe,EACf,OAAe,EACf,MAAgB,EAChB,OAAwB,EACxB,QAAoB,EACpB,cAAuB;IAEvB,kBAAkB;IAClB,IAAI,IAAI,GAAG,SAAS,CAClB,MAAM,EACN,UAAC,KAAa,EAAE,GAAW;QACzB,IAAM,CAAC,GACL,OAAO,GAAG,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;QACtE,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;IAC3C,CAAC,EACD,CAAC,CACF,CAAC;IACF,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IAEzB,IAAI,IAAI,GAAG,SAAS,CAClB,MAAM,EACN,UAAC,KAAa,EAAE,GAAW;QACzB,IAAM,CAAC,GAAG,QAAQ,CAAC,KAAK,GAAG,OAAO,GAAG,QAAQ,CAAC,CAAC,CAAC;QAChD,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;IAC3C,CAAC,EACD,IAAI,CACL,CAAC;IACF,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,EAAE,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAE5D,IAAA,KAA6B,OAAO,CAAC,aAAa,CACtD,OAAO,GAAG,QAAQ,CAAC,CAAC,EACpB,QAAQ,CAAC,MAAM,GAAG,OAAO,GAAG,QAAQ,CAAC,CAAC,CACvC,EAHc,IAAI,WAAA,EAAO,IAAI,SAG7B,CAAC;IAEF,gBAAgB;IAChB,oDAAoD;IACpD,qDAAqD;IACrD,2CAA2C;IAC3C,+BAA+B;IAC/B,6CAA6C;IAC7C,gCAAgC;IAEhC,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;AAClC,CAAC,CAAC;AAEF;;;;;GAKG;AACH,MAAM,CAAC,IAAM,gBAAgB,GAAG,UAC9B,CAAS,EACT,CAAS,EACT,KAAuB;IAEvB,IAAM,KAAK,GAAG,CAAC,CAAC,CAAC,QAAQ;IACzB,IAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IAE9B,iBAAiB;IACjB,IAAM,MAAM,GAAG,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1C,IAAM,MAAM,GAAG,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAErC,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,UAAU,EAAE,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;AAC9D,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,cAAc,GAAG,UAC5B,KAAa,EACb,OAAe,EACf,OAAe;;IAEf,IAAM,MAAM,GAAG,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,EAAE,CAAC;IAClC,IAAM,IAAI,GAAG,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAG,CAAC,CAAC,mCAAI,CAAC,CAAC;IAC9B,IAAM,IAAI,GAAG,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAG,CAAC,CAAC,mCAAI,CAAC,CAAC;IAC9B,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,CAAC,OAAO,GAAG,IAAI,EAAE,OAAO,GAAG,IAAI,CAAC,CAAC;AACnD,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,eAAe,GAAG,UAAC,KAAa,EAAE,OAAe;;IAC5D,IAAM,MAAM,GAAG,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,EAAE,CAAC;IAClC,IAAM,IAAI,GAAG,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAG,CAAC,CAAC,mCAAI,CAAC,CAAC;IAC9B,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,CAAC,OAAO,GAAG,IAAI,EAAE,CAAC,CAAC,CAAC;AACtC,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,eAAe,GAAG,UAAC,KAAa,EAAE,OAAe;;IAC5D,IAAM,MAAM,GAAG,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,EAAE,CAAC;IAClC,IAAM,IAAI,GAAG,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAG,CAAC,CAAC,mCAAI,CAAC,CAAC;IAC9B,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI,CAAC,CAAC;AACtC,CAAC,CAAC;AAEF;;;;;;;;;;;;;;GAcG;AACH,MAAM,CAAC,IAAM,qBAAqB,GAAG,UACnC,IAGC,EACD,UAAsB,EACtB,SAAiB,EACjB,SAGC;IAGC,IAAA,cAAc,GAIZ,UAAU,eAJE,EACd,cAAc,GAGZ,UAAU,eAHE,EACd,sBAAsB,GAEpB,UAAU,uBAFU,EACtB,sBAAsB,GACpB,UAAU,uBADU,CACT;IACP,IAAA,QAAQ,GAAe,IAAI,SAAnB,EAAE,QAAQ,GAAK,IAAI,SAAT,CAAU;IACpC,IAAI,WAAW,CAAC,QAAQ,EAAE,SAAS,CAAC,KAAK,EAAE,cAAc,CAAC,EAAE;QAC1D,OAAO,cAAc,CAAC,GAAG,CAAC;KAC3B;IAED,IAAI,mBAAmB,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,EAAE,sBAAsB,CAAC,EAAE;QACxE,OAAO,cAAc,CAAC,YAAY,CAAC;KACpC;IAED,IAAI,WAAW,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE;QACzC,OAAO,cAAc,CAAC,GAAG,CAAC;KAC3B;IAED,IAAI,mBAAmB,CAAC,QAAQ,EAAE,sBAAsB,EAAE,SAAS,CAAC,EAAE;QACpE,OAAO,cAAc,CAAC,YAAY,CAAC;KACpC;IACD,OAAO,cAAc,CAAC,MAAM,CAAC;AAC/B,CAAC,CAAC;AAEF;;GAEG;AACH,MAAM,CAAC,IAAM,0BAA0B,GAAG,UACxC,IAAgB,EAChB,SAAiB,EACjB,SAGC;;IAGC,IAAA,cAAc,GAIZ,IAAI,eAJQ,EACd,cAAc,GAGZ,IAAI,eAHQ,EACd,sBAAsB,GAEpB,IAAI,uBAFgB,EACtB,sBAAsB,GACpB,IAAI,uBADgB,CACf;IAET,IAAM,MAAM;QAGV,GAAC,cAAc,CAAC,GAAG,IAAG,EAAE;QACxB,GAAC,cAAc,CAAC,MAAM,IAAG,EAAE;WAC5B,CAAC;IAEF,iGAAiG;IACjG,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC,EAAE,EAAE;QACvC,KAAK,IAAI,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,GAAG,SAAS,CAAC,KAAK,GAAG,cAAc,EAAE,CAAC,EAAE,EAAE;YACvE,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBAC9B,CAAC,EAAE,CAAC;gBACJ,CAAC,EAAE,CAAC;aACL,CAAC,CAAC;SACJ;QAED,IAAI,sBAAsB,GAAG,CAAC,EAAE;YAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,sBAAsB,EAAE,CAAC,EAAE,EAAE;gBAC/C,IAAM,KAAK,GAAG,SAAS,CAAC,GAAG,GAAG,CAAC,CAAC;gBAChC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;oBACjC,CAAC,EAAE,CAAC;oBACJ,CAAC,EAAE,KAAK;iBACT,CAAC,CAAC;aACJ;SACF;KACF;IAED,2GAA2G;IAC3G,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,sBAAsB,EAAE,CAAC,EAAE,EAAE;QAC/C,IAAM,QAAQ,GAAG,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC;QACnC,KAAK,IAAI,CAAC,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,GAAG,SAAS,CAAC,KAAK,GAAG,cAAc,EAAE,CAAC,EAAE,EAAE;YACvE,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBAC9B,CAAC,EAAE,QAAQ;gBACX,CAAC,EAAE,CAAC;aACL,CAAC,CAAC;SACJ;QAED,IAAI,sBAAsB,GAAG,CAAC,EAAE;YAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,sBAAsB,EAAE,CAAC,EAAE,EAAE;gBAC/C,IAAM,KAAK,GAAG,SAAS,CAAC,GAAG,GAAG,CAAC,CAAC;gBAChC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;oBACjC,CAAC,EAAE,QAAQ;oBACX,CAAC,EAAE,KAAK;iBACT,CAAC,CAAC;aACJ;SACF;KACF;IAED,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,YAAY,GAAG,UAC1B,QAAgB,EAChB,QAAgB,EAChB,UAAsB,EACtB,SAAiB,EACjB,SAGC;IAGC,IAAA,cAAc,GAIZ,UAAU,eAJE,EACd,cAAc,GAGZ,UAAU,eAHE,EACd,sBAAsB,GAEpB,UAAU,uBAFU,EACtB,sBAAsB,GACpB,UAAU,uBADU,CACT;IACf,OAAO,CACL,WAAW,CAAC,QAAQ,EAAE,cAAc,CAAC;QACrC,mBAAmB,CAAC,QAAQ,EAAE,sBAAsB,EAAE,SAAS,CAAC;QAChE,WAAW,CAAC,QAAQ,EAAE,SAAS,CAAC,KAAK,EAAE,cAAc,CAAC;QACtD,mBAAmB,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,EAAE,sBAAsB,CAAC,CACrE,CAAC;AACJ,CAAC,CAAC;AAEF;;GAEG;AACH,MAAM,CAAC,IAAM,4BAA4B,GAAG,UAC1C,OAAgB,EAChB,UAAsB,EACtB,SAAiB,EACjB,SAGC;IAGC,IAAA,cAAc,GAIZ,UAAU,eAJE,EACd,cAAc,GAGZ,UAAU,eAHE,EACd,sBAAsB,GAEpB,UAAU,uBAFU,EACtB,sBAAsB,GACpB,UAAU,uBADU,CACT;IAEf,IAAM,aAAa,4BAAgB,OAAO,SAAC,CAAC;IAE5C,0CAA0C;IAC1C,IAAI,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,cAAc,CAAC,EAAE;QACjD,aAAa,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC;KACnC;IAED,IACE,mBAAmB,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,sBAAsB,EAAE,SAAS,CAAC,EACxE;QACA,aAAa,CAAC,CAAC,CAAC,GAAG,SAAS,GAAG,sBAAsB,GAAG,CAAC,CAAC;KAC3D;IAED,IAAI,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,EAAE,cAAc,CAAC,EAAE;QAClE,aAAa,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,KAAK,GAAG,cAAc,CAAC;KACrD;IAED,IACE,mBAAmB,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,GAAG,EAAE,sBAAsB,CAAC,EAC5E;QACA,aAAa,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,GAAG,GAAG,sBAAsB,CAAC;KAC3D;IAED,2CAA2C;IAC3C,IAAM,gBAAgB,4BAAgB,aAAa,SAAC,CAAC;IACrD,gBAAgB,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC;IACtC,gBAAgB,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,KAAK,GAAG,cAAc,GAAG,CAAC,CAAC;IAE3D,IAAM,gBAAgB,4BAAgB,aAAa,SAAC,CAAC;IACrD,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACxB,gBAAgB,CAAC,CAAC,CAAC,GAAG,cAAc,GAAG,CAAC,CAAC;IAEzC,IAAM,wBAAwB,4BAAgB,aAAa,SAAC,CAAC;IAC7D,wBAAwB,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,GAAG,GAAG,CAAC,GAAG,sBAAsB,CAAC;IACzE,wBAAwB,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC;IAE5C,IAAM,wBAAwB,4BAAgB,aAAa,SAAC,CAAC;IAC7D,wBAAwB,CAAC,CAAC,CAAC,GAAG,SAAS,GAAG,sBAAsB,CAAC;IACjE,wBAAwB,CAAC,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;IAE5C,OAAO;QACL,MAAM,EAAE,aAAa;QACrB,SAAS,EAAE,gBAAgB;QAC3B,SAAS,EAAE,gBAAgB;QAC3B,iBAAiB,EAAE,wBAAwB;QAC3C,iBAAiB,EAAE,wBAAwB;KAC5C,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,IAAM,YAAY,GAAG,UAC1B,eAAgC,EAChC,UAAuB;IAEvB,IAAM,OAAO,GAAG,eAAe,CAAC;IAChC,IAAI,KAAK,GAAG,CAAC,CAAC;IACd,IAAI,GAAG,GAAG,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;IAEvC,IAAI,UAAU,EAAE;QACN,IAAA,OAAO,GAAe,UAAU,QAAzB,EAAE,QAAQ,GAAK,UAAU,SAAf,CAAgB;QAEzC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,QAAQ,EAAE,CAAC,CAAC,CAAC;QAC9C,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,QAAQ,GAAG,CAAC,EAAE,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC,CAAC;KACtE;IAED,OAAO;QACL,KAAK,OAAA;QACL,GAAG,KAAA;KACJ,CAAC;AACJ,CAAC,CAAC\"}","dts":{"name":"F:/Ismart/S2-master/packages/s2-core/node_modules/.cache/rollup-plugin-typescript2/placeholder/facet/utils.d.ts","writeByteOrderMark":false,"text":"import { SimpleBBox, IGroup } from '@antv/g-canvas';\r\nimport { Indexes } from '../utils/indexes';\r\nimport { ViewCellHeights } from './layout/interface';\r\nimport { FrozenCellType, FrozenOpts, FrozenCellIndex } from \"../common/constant/frozen\";\r\nimport { Pagination, ScrollSpeedRatio } from \"../common/interface\";\r\nexport declare const isFrozenCol: (colIndex: number, frozenCount: number) => boolean;\r\nexport declare const isFrozenTrailingCol: (colIndex: number, frozenCount: number, colLength: number) => boolean;\r\nexport declare const isFrozenRow: (rowIndex: number, minRowIndex: number, frozenCount: number) => boolean;\r\nexport declare const isFrozenTrailingRow: (rowIndex: number, maxRowIndex: number, frozenCount: number) => boolean;\r\n/**\r\n * 计算偏移 scrollX、scrollY 的时候，在视窗中的节点索引\r\n * @param scrollX\r\n * @param scrollY\r\n * @param widths\r\n * @param heights\r\n * @param viewport\r\n * @param rowRemainWidth\r\n */\r\nexport declare const calculateInViewIndexes: (scrollX: number, scrollY: number, widths: number[], heights: ViewCellHeights, viewport: SimpleBBox, rowRemainWidth?: number) => Indexes;\r\n/**\r\n * 优化滚动方向，对于小角度的滚动，固定为一个方向\r\n * @param x\r\n * @param y\r\n * @param ratio\r\n */\r\nexport declare const optimizeScrollXY: (x: number, y: number, ratio: ScrollSpeedRatio) => [number, number];\r\nexport declare const translateGroup: (group: IGroup, scrollX: number, scrollY: number) => void;\r\nexport declare const translateGroupX: (group: IGroup, scrollX: number) => void;\r\nexport declare const translateGroupY: (group: IGroup, scrollY: number) => void;\r\n/**\r\n * frozen                     frozenTrailing\r\n * ColCount                   ColCount\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * |     |     frozenRow     |          |  frozenRowCount\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * | fro |                   | fro      |\r\n * | zen |      panel        | zen      |\r\n * | col |      scroll       | trailing |\r\n * |     |                   | col      |\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * |     | frozenTrailingRow |          |  frozenTrailingRowCount\r\n * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n * @description returns which group data cell belongs in frozen mode\r\n */\r\nexport declare const getFrozenDataCellType: (meta: {\r\n    colIndex: number;\r\n    rowIndex: number;\r\n}, frozenOpts: FrozenOpts, colLength: number, cellRange: {\r\n    start: number;\r\n    end: number;\r\n}) => FrozenCellType.ROW | FrozenCellType.COL | FrozenCellType.TRAILING_ROW | FrozenCellType.TRAILING_COL | FrozenCellType.SCROLL;\r\n/**\r\n * @description calculate all cells in frozen group's intersection region\r\n */\r\nexport declare const calculateFrozenCornerCells: (opts: FrozenOpts, colLength: number, cellRange: {\r\n    start: number;\r\n    end: number;\r\n}) => {\r\n    [key: string]: FrozenCellIndex[];\r\n};\r\nexport declare const isFrozenCell: (colIndex: number, rowIndex: number, frozenOpts: FrozenOpts, colLength: number, cellRange: {\r\n    start: number;\r\n    end: number;\r\n}) => boolean;\r\n/**\r\n * @description split all cells in current panel with five child group\r\n */\r\nexport declare const splitInViewIndexesWithFrozen: (indexes: Indexes, frozenOpts: FrozenOpts, colLength: number, cellRange: {\r\n    start: number;\r\n    end: number;\r\n}) => {\r\n    center: Indexes;\r\n    frozenRow: Indexes;\r\n    frozenCol: Indexes;\r\n    frozenTrailingCol: Indexes;\r\n    frozenTrailingRow: Indexes;\r\n};\r\nexport declare const getCellRange: (viewCellHeights: ViewCellHeights, pagination?: Pagination) => {\r\n    start: number;\r\n    end: number;\r\n};\r\n"}}
