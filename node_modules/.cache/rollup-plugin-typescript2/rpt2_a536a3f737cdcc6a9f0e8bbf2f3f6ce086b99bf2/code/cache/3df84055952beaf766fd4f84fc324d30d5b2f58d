{"code":"import { __assign, __extends } from \"tslib\";\r\nimport { get, isEmpty, find, head } from 'lodash';\r\nimport { BaseEvent } from '../../base-event';\r\nimport { S2Event, InterceptType } from \"../../../common/constant\";\r\n/**\r\n * Row header click navigation interaction\r\n */\r\nvar RowTextClick = /** @class */ (function (_super) {\r\n    __extends(RowTextClick, _super);\r\n    function RowTextClick() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.getRowData = function (cellData) {\r\n            var node = cellData;\r\n            var nodeData = {};\r\n            while (node.parent) {\r\n                nodeData[node.key] = node.value;\r\n                node = node.parent;\r\n            }\r\n            var rowIndex = _this.getRowIndex(cellData);\r\n            var originalRowData = _this.getOriginalRowData(cellData, rowIndex);\r\n            var rowData = __assign(__assign(__assign({}, originalRowData), nodeData), { rowIndex: rowIndex });\r\n            return rowData;\r\n        };\r\n        _this.getOriginalRowData = function (cellData, rowIndex) {\r\n            var _a;\r\n            var options = _this.spreadsheet.options;\r\n            var _b = ((_a = options === null || options === void 0 ? void 0 : options.totals) === null || _a === void 0 ? void 0 : _a.row) || {}, showGrandTotals = _b.showGrandTotals, showSubTotals = _b.showSubTotals, reverseLayout = _b.reverseLayout, reverseSubLayout = _b.reverseSubLayout;\r\n            // If grand totals, sub totals enabled and in the table head\r\n            var grandTotalsRowIndexDiff = showGrandTotals && reverseLayout ? 1 : 0;\r\n            var subTotalsRowIndexDiff = showSubTotals && reverseSubLayout ? 1 : 0;\r\n            var dataIndex = Math.max(0, rowIndex - grandTotalsRowIndexDiff - subTotalsRowIndexDiff);\r\n            var currentRowData = find(_this.spreadsheet.dataCfg.data, function (row, index) {\r\n                return row[cellData.key] === cellData.value && index === dataIndex;\r\n            });\r\n            return currentRowData;\r\n        };\r\n        _this.getRowIndex = function (cellData) {\r\n            var _a, _b;\r\n            var isTree = _this.spreadsheet.options.hierarchyType === 'tree';\r\n            if (isTree) {\r\n                var child = cellData;\r\n                while (!isEmpty(child.children)) {\r\n                    child = head(child.children);\r\n                }\r\n                return (_a = cellData.rowIndex) !== null && _a !== void 0 ? _a : child.rowIndex;\r\n            }\r\n            // if current cell has no row index, return dynamic computed value\r\n            var rowIndex = Math.floor(cellData.y / cellData.height);\r\n            return (_b = cellData.rowIndex) !== null && _b !== void 0 ? _b : rowIndex;\r\n        };\r\n        return _this;\r\n    }\r\n    RowTextClick.prototype.bindEvents = function () {\r\n        this.bindRowCellClick();\r\n    };\r\n    RowTextClick.prototype.bindRowCellClick = function () {\r\n        var _this = this;\r\n        this.spreadsheet.on(S2Event.ROW_CELL_CLICK, function (event) {\r\n            if (_this.spreadsheet.interaction.hasIntercepts([InterceptType.CLICK])) {\r\n                return;\r\n            }\r\n            var appendInfo = get(event.target, 'attrs.appendInfo', {});\r\n            if (appendInfo.isRowHeaderText) {\r\n                var cellData = appendInfo.cellData;\r\n                var key = cellData.key;\r\n                var rowData = _this.getRowData(cellData);\r\n                _this.spreadsheet.emit(S2Event.GLOBAL_LINK_FIELD_JUMP, {\r\n                    key: key,\r\n                    record: rowData,\r\n                });\r\n            }\r\n        });\r\n    };\r\n    return RowTextClick;\r\n}(BaseEvent));\r\nexport { RowTextClick };\r\n//# sourceMappingURL=row-text-click.js.map","references":["F:/Ismart/S2-master/node_modules/@antv/g-canvas/lib/index.d.ts","F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/interaction/base-event.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/node.ts"],"map":"{\"version\":3,\"file\":\"row-text-click.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/interaction/base-interaction/click/row-text-click.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"F:/Ismart/S2-master/packages/s2-core/node_modules/.cache/rollup-plugin-typescript2/placeholder/interaction/base-interaction/click/row-text-click.d.ts","writeByteOrderMark":false,"text":"import { BaseEvent, BaseEventImplement } from '../../base-event';\r\n/**\r\n * Row header click navigation interaction\r\n */\r\nexport declare class RowTextClick extends BaseEvent implements BaseEventImplement {\r\n    bindEvents(): void;\r\n    private bindRowCellClick;\r\n    private getRowData;\r\n    private getOriginalRowData;\r\n    private getRowIndex;\r\n}\r\n"}}
