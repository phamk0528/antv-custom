{"code":"import { __assign, __extends } from \"tslib\";\r\nimport { get } from 'lodash';\r\nimport { getTooltipOptions, getTooltipVisibleOperator, } from '../../../utils/tooltip';\r\nimport { getCellMeta } from \"../../../utils/interaction/select-event\";\r\nimport { InteractionStateName, InterceptType, S2Event, TOOLTIP_OPERATOR_TREND_MENU, } from \"../../../common/constant\";\r\nimport { BaseEvent } from \"../../base-event\";\r\nvar DataCellClick = /** @class */ (function (_super) {\r\n    __extends(DataCellClick, _super);\r\n    function DataCellClick() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DataCellClick.prototype.bindEvents = function () {\r\n        this.bindDataCellClick();\r\n    };\r\n    DataCellClick.prototype.bindDataCellClick = function () {\r\n        var _this = this;\r\n        this.spreadsheet.on(S2Event.DATA_CELL_CLICK, function (event) {\r\n            event.stopPropagation();\r\n            var interaction = _this.spreadsheet.interaction;\r\n            if (interaction.hasIntercepts([InterceptType.CLICK])) {\r\n                return;\r\n            }\r\n            interaction.clearHoverTimer();\r\n            _this.emitLinkFieldClickEvent(event);\r\n            var cell = _this.spreadsheet.getCell(event.target);\r\n            var meta = cell.getMeta();\r\n            if (!meta) {\r\n                return;\r\n            }\r\n            interaction.addIntercepts([InterceptType.HOVER]);\r\n            if (interaction.isSelectedCell(cell)) {\r\n                interaction.reset();\r\n                return;\r\n            }\r\n            interaction.clearState();\r\n            interaction.changeState({\r\n                cells: [getCellMeta(cell)],\r\n                stateName: InteractionStateName.SELECTED,\r\n            });\r\n            _this.spreadsheet.emit(S2Event.GLOBAL_SELECTED, [cell]);\r\n            _this.showTooltip(event, meta);\r\n        });\r\n    };\r\n    DataCellClick.prototype.getTooltipOperator = function (event, meta) {\r\n        var _this = this;\r\n        var cell = this.spreadsheet.getCell(event.target);\r\n        var operation = getTooltipOptions(this.spreadsheet, event).operation;\r\n        var trendMenu = operation.trend && __assign(__assign({}, TOOLTIP_OPERATOR_TREND_MENU), { onClick: function () {\r\n                _this.spreadsheet.emit(S2Event.DATA_CELL_TREND_ICON_CLICK, meta);\r\n                _this.spreadsheet.hideTooltip();\r\n            } });\r\n        return getTooltipVisibleOperator(operation, {\r\n            defaultMenus: [trendMenu],\r\n            cell: cell,\r\n        });\r\n    };\r\n    DataCellClick.prototype.showTooltip = function (event, meta) {\r\n        var data = meta.data, _a = meta.isTotals, isTotals = _a === void 0 ? false : _a, value = meta.value, fieldValue = meta.fieldValue, field = meta.field, valueField = meta.valueField;\r\n        var currentCellMeta = data;\r\n        var showSingleTips = this.spreadsheet.isTableMode();\r\n        var cellData = showSingleTips\r\n            ? __assign(__assign({}, currentCellMeta), { value: value || fieldValue, valueField: field || valueField }) : currentCellMeta;\r\n        var cellInfos = [\r\n            cellData || __assign(__assign({}, meta.rowQuery), meta.colQuery),\r\n        ];\r\n        var operator = this.getTooltipOperator(event, meta);\r\n        this.spreadsheet.showTooltipWithInfo(event, cellInfos, {\r\n            isTotals: isTotals,\r\n            operator: operator,\r\n            enterable: true,\r\n            hideSummary: true,\r\n            showSingleTips: showSingleTips,\r\n        });\r\n    };\r\n    DataCellClick.prototype.emitLinkFieldClickEvent = function (event) {\r\n        var appendInfo = get(event.target, 'attrs.appendInfo', {});\r\n        if (appendInfo.isRowHeaderText) {\r\n            var cellData = appendInfo.cellData;\r\n            var key = cellData.valueField, record = cellData.data;\r\n            this.spreadsheet.emit(S2Event.GLOBAL_LINK_FIELD_JUMP, {\r\n                key: key,\r\n                record: record,\r\n            });\r\n        }\r\n    };\r\n    return DataCellClick;\r\n}(BaseEvent));\r\nexport { DataCellClick };\r\n//# sourceMappingURL=data-cell-click.js.map","references":["F:/Ismart/S2-master/node_modules/@antv/g-canvas/lib/index.d.ts","F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/tooltip.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/interaction/select-event.ts","F:/Ismart/S2-master/packages/s2-core/src/cell/data-cell.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts","F:/Ismart/S2-master/packages/s2-core/src/interaction/base-event.ts"],"map":"{\"version\":3,\"file\":\"data-cell-click.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/interaction/base-interaction/click/data-cell-click.ts\"],\"names\":[],\"mappings\":\"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\"}"}
