{"code":"import { __extends } from \"tslib\";\r\nimport { Group } from '@antv/g-canvas';\r\nimport { translateGroup } from \"../utils\";\r\nvar Frame = /** @class */ (function (_super) {\r\n    __extends(Frame, _super);\r\n    function Frame(cfg) {\r\n        var _this = _super.call(this, cfg) || this;\r\n        _this.render();\r\n        return _this;\r\n    }\r\n    Frame.prototype.layout = function () {\r\n        // corner底部的横线条\r\n        this.addCornerBottomBorder();\r\n        // corner右边的竖线条\r\n        this.addCornerRightBorder();\r\n        // 一级纵向分割线两侧的shadow\r\n        this.addSplitLineShadow();\r\n    };\r\n    /**\r\n     * 渲染\r\n     */\r\n    Frame.prototype.render = function () {\r\n        this.clear();\r\n        this.layout();\r\n    };\r\n    Frame.prototype.onBorderScroll = function (scrollX) {\r\n        this.cfg.scrollX = scrollX;\r\n        var position = this.cfg.position;\r\n        translateGroup(this, position.x - scrollX, 0);\r\n        this.render();\r\n    };\r\n    Frame.prototype.onChangeShadowVisibility = function (scrollX, maxScrollX) {\r\n        this.cfg.showViewportLeftShadow = scrollX > 0;\r\n        // baseFacet#renderHScrollBar render condition\r\n        this.cfg.showViewportRightShadow =\r\n            Math.floor(scrollX) < Math.floor(maxScrollX);\r\n        this.render();\r\n    };\r\n    Frame.prototype.addCornerRightBorder = function () {\r\n        var _a;\r\n        var cfg = this.cfg;\r\n        // 是否是透视表\r\n        var isPivotMode = cfg.isPivotMode;\r\n        // 明细表啥也不要\r\n        if (!isPivotMode) {\r\n            return;\r\n        }\r\n        var width = cfg.width, height = cfg.height, viewportHeight = cfg.viewportHeight, position = cfg.position, spreadsheet = cfg.spreadsheet;\r\n        var splitLine = (_a = spreadsheet.theme) === null || _a === void 0 ? void 0 : _a.splitLine;\r\n        var x = position.x + width;\r\n        var y1 = position.y;\r\n        var y2 = position.y + height + viewportHeight;\r\n        this.addShape('line', {\r\n            attrs: {\r\n                x1: x,\r\n                y1: y1,\r\n                x2: x,\r\n                y2: y2,\r\n                stroke: splitLine.verticalBorderColor,\r\n                lineWidth: splitLine.verticalBorderWidth,\r\n                opacity: splitLine.verticalBorderColorOpacity,\r\n            },\r\n        });\r\n    };\r\n    Frame.prototype.addCornerBottomBorder = function () {\r\n        var _a;\r\n        var cfg = this.cfg;\r\n        var width = cfg.width, height = cfg.height, viewportWidth = cfg.viewportWidth, position = cfg.position, scrollX = cfg.scrollX, scrollContainsRowHeader = cfg.scrollContainsRowHeader, spreadsheet = cfg.spreadsheet;\r\n        var splitLine = (_a = spreadsheet.theme) === null || _a === void 0 ? void 0 : _a.splitLine;\r\n        var x1 = position.x;\r\n        var x2 = x1 + width + viewportWidth + (scrollContainsRowHeader ? scrollX : 0);\r\n        var y = position.y + height - 1;\r\n        this.addShape('line', {\r\n            attrs: {\r\n                x1: x1,\r\n                y1: y,\r\n                x2: x2,\r\n                y2: y,\r\n                stroke: splitLine.horizontalBorderColor,\r\n                lineWidth: splitLine.horizontalBorderWidth,\r\n                opacity: splitLine.horizontalBorderColorOpacity,\r\n            },\r\n        });\r\n    };\r\n    Frame.prototype.addSplitLineShadow = function () {\r\n        var _a;\r\n        var cfg = this.cfg;\r\n        var isPivotMode = cfg.isPivotMode, spreadsheet = cfg.spreadsheet;\r\n        var splitLine = (_a = spreadsheet.theme) === null || _a === void 0 ? void 0 : _a.splitLine;\r\n        if (!isPivotMode ||\r\n            !splitLine.showShadow ||\r\n            !spreadsheet.isFrozenRowHeader()) {\r\n            return;\r\n        }\r\n        // do render...\r\n        this.addSplitLineLeftShadow();\r\n        this.addSplitLineRightShadow();\r\n    };\r\n    Frame.prototype.addSplitLineLeftShadow = function () {\r\n        var _a, _b, _c;\r\n        if (!this.cfg.showViewportLeftShadow) {\r\n            return;\r\n        }\r\n        var _d = this.cfg, width = _d.width, height = _d.height, viewportHeight = _d.viewportHeight, position = _d.position, spreadsheet = _d.spreadsheet;\r\n        var splitLine = (_a = spreadsheet.theme) === null || _a === void 0 ? void 0 : _a.splitLine;\r\n        var x = position.x + width;\r\n        var y = position.y;\r\n        this.addShape('rect', {\r\n            attrs: {\r\n                x: x,\r\n                y: y,\r\n                width: splitLine.shadowWidth,\r\n                height: viewportHeight + height,\r\n                fill: \"l (0) 0:\".concat((_b = splitLine.shadowColors) === null || _b === void 0 ? void 0 : _b.left, \" 1:\").concat((_c = splitLine.shadowColors) === null || _c === void 0 ? void 0 : _c.right),\r\n            },\r\n        });\r\n    };\r\n    Frame.prototype.addSplitLineRightShadow = function () {\r\n        var _a, _b, _c;\r\n        if (!this.cfg.showViewportRightShadow) {\r\n            return;\r\n        }\r\n        var _d = this.cfg, width = _d.width, height = _d.height, viewportHeight = _d.viewportHeight, viewportWidth = _d.viewportWidth, position = _d.position, spreadsheet = _d.spreadsheet;\r\n        var splitLine = (_a = spreadsheet.theme) === null || _a === void 0 ? void 0 : _a.splitLine;\r\n        var x = position.x + width + viewportWidth - splitLine.shadowWidth;\r\n        var y = position.y;\r\n        this.addShape('rect', {\r\n            attrs: {\r\n                x: x,\r\n                y: y,\r\n                width: splitLine.shadowWidth,\r\n                height: viewportHeight + height,\r\n                fill: \"l (0) 0:\".concat((_b = splitLine.shadowColors) === null || _b === void 0 ? void 0 : _b.right, \" 1:\").concat((_c = splitLine.shadowColors) === null || _c === void 0 ? void 0 : _c.left),\r\n            },\r\n        });\r\n    };\r\n    return Frame;\r\n}(Group));\r\nexport { Frame };\r\n//# sourceMappingURL=frame.js.map","references":["F:/Ismart/S2-master/node_modules/@antv/g-canvas/lib/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/utils.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts"],"map":"{\"version\":3,\"file\":\"frame.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/facet/header/frame.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,gBAAgB,CAAC;AACvC,OAAO,EAAE,cAAc,EAAE,iBAAsB;AAG/C;IAA2B,yBAAK;IAG9B,eAAY,GAAgB;QAA5B,YACE,kBAAM,GAAG,CAAC,SAEX;QADC,KAAI,CAAC,MAAM,EAAE,CAAC;;IAChB,CAAC;IAEM,sBAAM,GAAb;QACE,eAAe;QACf,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,eAAe;QACf,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,mBAAmB;QACnB,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC5B,CAAC;IAED;;OAEG;IACI,sBAAM,GAAb;QACE,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAEM,8BAAc,GAArB,UAAsB,OAAe;QACnC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,OAAO,CAAC;QACnB,IAAA,QAAQ,GAAK,IAAI,CAAC,GAAG,SAAb,CAAc;QAC9B,cAAc,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,GAAG,OAAO,EAAE,CAAC,CAAC,CAAC;QAC9C,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAEM,wCAAwB,GAA/B,UAAgC,OAAe,EAAE,UAAkB;QACjE,IAAI,CAAC,GAAG,CAAC,sBAAsB,GAAG,OAAO,GAAG,CAAC,CAAC;QAC9C,8CAA8C;QAC9C,IAAI,CAAC,GAAG,CAAC,uBAAuB;YAC9B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QAE/C,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAEO,oCAAoB,GAA5B;;QACE,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QACrB,SAAS;QACD,IAAA,WAAW,GAAK,GAAG,YAAR,CAAS;QAC5B,UAAU;QACV,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QACO,IAAA,KAAK,GAAoD,GAAG,MAAvD,EAAE,MAAM,GAA4C,GAAG,OAA/C,EAAE,cAAc,GAA4B,GAAG,eAA/B,EAAE,QAAQ,GAAkB,GAAG,SAArB,EAAE,WAAW,GAAK,GAAG,YAAR,CAAS;QACrE,IAAM,SAAS,GAAG,MAAA,WAAW,CAAC,KAAK,0CAAE,SAAS,CAAC;QAC/C,IAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,KAAK,CAAC;QAC7B,IAAM,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC;QACtB,IAAM,EAAE,GAAG,QAAQ,CAAC,CAAC,GAAG,MAAM,GAAG,cAAc,CAAC;QAChD,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACpB,KAAK,EAAE;gBACL,EAAE,EAAE,CAAC;gBACL,EAAE,IAAA;gBACF,EAAE,EAAE,CAAC;gBACL,EAAE,IAAA;gBACF,MAAM,EAAE,SAAS,CAAC,mBAAmB;gBACrC,SAAS,EAAE,SAAS,CAAC,mBAAmB;gBACxC,OAAO,EAAE,SAAS,CAAC,0BAA0B;aAC9C;SACF,CAAC,CAAC;IACL,CAAC;IAEO,qCAAqB,GAA7B;;QACE,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QAEnB,IAAA,KAAK,GAOH,GAAG,MAPA,EACL,MAAM,GAMJ,GAAG,OANC,EACN,aAAa,GAKX,GAAG,cALQ,EACb,QAAQ,GAIN,GAAG,SAJG,EACR,OAAO,GAGL,GAAG,QAHE,EACP,uBAAuB,GAErB,GAAG,wBAFkB,EACvB,WAAW,GACT,GAAG,YADM,CACL;QACR,IAAM,SAAS,GAAG,MAAA,WAAW,CAAC,KAAK,0CAAE,SAAS,CAAC;QAC/C,IAAM,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC;QACtB,IAAM,EAAE,GACN,EAAE,GAAG,KAAK,GAAG,aAAa,GAAG,CAAC,uBAAuB,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACvE,IAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,CAAC;QAClC,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACpB,KAAK,EAAE;gBACL,EAAE,IAAA;gBACF,EAAE,EAAE,CAAC;gBACL,EAAE,IAAA;gBACF,EAAE,EAAE,CAAC;gBACL,MAAM,EAAE,SAAS,CAAC,qBAAqB;gBACvC,SAAS,EAAE,SAAS,CAAC,qBAAqB;gBAC1C,OAAO,EAAE,SAAS,CAAC,4BAA4B;aAChD;SACF,CAAC,CAAC;IACL,CAAC;IAEO,kCAAkB,GAA1B;;QACE,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QACb,IAAA,WAAW,GAAkB,GAAG,YAArB,EAAE,WAAW,GAAK,GAAG,YAAR,CAAS;QACzC,IAAM,SAAS,GAAG,MAAA,WAAW,CAAC,KAAK,0CAAE,SAAS,CAAC;QAE/C,IACE,CAAC,WAAW;YACZ,CAAC,SAAS,CAAC,UAAU;YACrB,CAAC,WAAW,CAAC,iBAAiB,EAAE,EAChC;YACA,OAAO;SACR;QAED,eAAe;QACf,IAAI,CAAC,sBAAsB,EAAE,CAAC;QAC9B,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACjC,CAAC;IAEO,sCAAsB,GAA9B;;QACE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,sBAAsB,EAAE;YACpC,OAAO;SACR;QAEK,IAAA,KAA2D,IAAI,CAAC,GAAG,EAAjE,KAAK,WAAA,EAAE,MAAM,YAAA,EAAE,cAAc,oBAAA,EAAE,QAAQ,cAAA,EAAE,WAAW,iBAAa,CAAC;QAC1E,IAAM,SAAS,GAAG,MAAA,WAAW,CAAC,KAAK,0CAAE,SAAS,CAAC;QAC/C,IAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,KAAK,CAAC;QAC7B,IAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACpB,KAAK,EAAE;gBACL,CAAC,GAAA;gBACD,CAAC,GAAA;gBACD,KAAK,EAAE,SAAS,CAAC,WAAW;gBAC5B,MAAM,EAAE,cAAc,GAAG,MAAM;gBAC/B,IAAI,EAAE,kBAAW,MAAA,SAAS,CAAC,YAAY,0CAAE,IAAI,gBAAM,MAAA,SAAS,CAAC,YAAY,0CAAE,KAAK,CAAE;aACnF;SACF,CAAC,CAAC;IACL,CAAC;IAEO,uCAAuB,GAA/B;;QACE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,uBAAuB,EAAE;YACrC,OAAO;SACR;QAEK,IAAA,KAOF,IAAI,CAAC,GAAG,EANV,KAAK,WAAA,EACL,MAAM,YAAA,EACN,cAAc,oBAAA,EACd,aAAa,mBAAA,EACb,QAAQ,cAAA,EACR,WAAW,iBACD,CAAC;QACb,IAAM,SAAS,GAAG,MAAA,WAAW,CAAC,KAAK,0CAAE,SAAS,CAAC;QAC/C,IAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,KAAK,GAAG,aAAa,GAAG,SAAS,CAAC,WAAW,CAAC;QACrE,IAAM,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACpB,KAAK,EAAE;gBACL,CAAC,GAAA;gBACD,CAAC,GAAA;gBACD,KAAK,EAAE,SAAS,CAAC,WAAW;gBAC5B,MAAM,EAAE,cAAc,GAAG,MAAM;gBAC/B,IAAI,EAAE,kBAAW,MAAA,SAAS,CAAC,YAAY,0CAAE,KAAK,gBAAM,MAAA,SAAS,CAAC,YAAY,0CAAE,IAAI,CAAE;aACnF;SACF,CAAC,CAAC;IACL,CAAC;IACH,YAAC;AAAD,CAAC,AAhKD,CAA2B,KAAK,GAgK/B\"}"}
