{"code":"import { __read, __spreadArray } from \"tslib\";\r\nimport { map } from 'lodash';\r\nimport { SERIES_NUMBER_FIELD } from \"../../common/constant\";\r\nimport { i18n } from \"../../common/i18n\";\r\nimport { generateHeaderNodes } from \"../../utils/layout/generate-header-nodes\";\r\nexport var buildTableHierarchy = function (params) {\r\n    var facetCfg = params.facetCfg, hierarchy = params.hierarchy, parentNode = params.parentNode;\r\n    var columns = facetCfg.columns, spreadsheet = facetCfg.spreadsheet, dataSet = facetCfg.dataSet;\r\n    var hiddenColumnsDetail = spreadsheet.store.get('hiddenColumnsDetail');\r\n    var showSeriesNumber = facetCfg === null || facetCfg === void 0 ? void 0 : facetCfg.showSeriesNumber;\r\n    var displayedColumns = columns.filter(function (column) {\r\n        if (!hiddenColumnsDetail) {\r\n            return true;\r\n        }\r\n        return hiddenColumnsDetail.every(function (detail) {\r\n            return detail.hideColumnNodes.every(function (node) {\r\n                return node.field !== column;\r\n            });\r\n        });\r\n    });\r\n    var fields = __spreadArray([], __read(displayedColumns), false);\r\n    var fieldValues = map(displayedColumns, function (val) { return dataSet.getFieldName(val); });\r\n    if (showSeriesNumber) {\r\n        fields.unshift(SERIES_NUMBER_FIELD);\r\n        fieldValues.unshift(i18n('序号'));\r\n    }\r\n    generateHeaderNodes({\r\n        currentField: displayedColumns[0],\r\n        fields: fields,\r\n        fieldValues: fieldValues,\r\n        facetCfg: facetCfg,\r\n        hierarchy: hierarchy,\r\n        parentNode: parentNode,\r\n        level: 0,\r\n        query: {},\r\n        addMeasureInTotalQuery: false,\r\n        addTotalMeasureInTotal: false,\r\n    });\r\n};\r\n//# sourceMappingURL=build-table-hierarchy.js.map","references":["F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/facet/layout/interface.ts","F:/Ismart/S2-master/packages/s2-core/src/common/constant/index.ts","F:/Ismart/S2-master/packages/s2-core/src/common/i18n/index.ts","F:/Ismart/S2-master/packages/s2-core/src/utils/layout/generate-header-nodes.ts"],"map":"{\"version\":3,\"file\":\"build-table-hierarchy.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/facet/layout/build-table-hierarchy.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,QAAQ,CAAC;AAE7B,OAAO,EAAE,mBAAmB,EAAE,8BAA0B;AACxD,OAAO,EAAE,IAAI,EAAE,0BAAsB;AACrC,OAAO,EAAE,mBAAmB,EAAE,iDAA6C;AAE3E,MAAM,CAAC,IAAM,mBAAmB,GAAG,UAAC,MAAyB;IACnD,IAAA,QAAQ,GAA4B,MAAM,SAAlC,EAAE,SAAS,GAAiB,MAAM,UAAvB,EAAE,UAAU,GAAK,MAAM,WAAX,CAAY;IAC3C,IAAA,OAAO,GAA2B,QAAQ,QAAnC,EAAE,WAAW,GAAc,QAAQ,YAAtB,EAAE,OAAO,GAAK,QAAQ,QAAb,CAAc;IAEnD,IAAM,mBAAmB,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;IACzE,IAAM,gBAAgB,GAAG,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,gBAAgB,CAAC;IAEpD,IAAM,gBAAgB,GAAG,OAAO,CAAC,MAAM,CAAC,UAAC,MAAM;QAC7C,IAAI,CAAC,mBAAmB,EAAE;YACxB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,mBAAmB,CAAC,KAAK,CAAC,UAAC,MAAM;YACtC,OAAO,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,UAAC,IAAI;gBACvC,OAAO,IAAI,CAAC,KAAK,KAAK,MAAM,CAAC;YAC/B,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IACH,IAAM,MAAM,4BAAO,gBAAgB,SAAC,CAAC;IAErC,IAAM,WAAW,GAAG,GAAG,CAAC,gBAAgB,EAAE,UAAC,GAAG,IAAK,OAAA,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAzB,CAAyB,CAAC,CAAC;IAE9E,IAAI,gBAAgB,EAAE;QACpB,MAAM,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;QACpC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACjC;IAED,mBAAmB,CAAC;QAClB,YAAY,EAAE,gBAAgB,CAAC,CAAC,CAAC;QACjC,MAAM,QAAA;QACN,WAAW,aAAA;QACX,QAAQ,UAAA;QACR,SAAS,WAAA;QACT,UAAU,YAAA;QACV,KAAK,EAAE,CAAC;QACR,KAAK,EAAE,EAAE;QACT,sBAAsB,EAAE,KAAK;QAC7B,sBAAsB,EAAE,KAAK;KAC9B,CAAC,CAAC;AACL,CAAC,CAAC\"}"}
