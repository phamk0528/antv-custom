{"code":"import { filter, isUndefined, keys, get, reduce, every } from 'lodash';\r\nexport var getListBySorted = function (list, sorted) {\r\n    return list.sort(function (a, b) {\r\n        var ia = sorted.indexOf(a);\r\n        var ib = sorted.indexOf(b);\r\n        if (ia === -1 && ib === -1) {\r\n            return 0;\r\n        }\r\n        if (ia === -1) {\r\n            return 1;\r\n        }\r\n        if (ib === -1) {\r\n            return -1;\r\n        }\r\n        return ia - ib;\r\n    });\r\n};\r\nexport var filterUndefined = function (values) {\r\n    return filter(values, function (t) { return !isUndefined(t) && t !== 'undefined'; });\r\n};\r\nexport var flattenDeep = function (data) {\r\n    var _a;\r\n    return (_a = keys(data)) === null || _a === void 0 ? void 0 : _a.reduce(function (pre, next) {\r\n        var item = get(data, next);\r\n        if (Array.isArray(item)) {\r\n            pre = pre.concat(flattenDeep(item));\r\n        }\r\n        else {\r\n            pre === null || pre === void 0 ? void 0 : pre.push(item);\r\n        }\r\n        return pre;\r\n    }, []);\r\n};\r\nexport var flatten = function (data) {\r\n    var _a;\r\n    var result = [];\r\n    if (Array.isArray(data)) {\r\n        (_a = keys(data)) === null || _a === void 0 ? void 0 : _a.forEach(function (item) {\r\n            var _a, _b;\r\n            var current = get(data, item);\r\n            if ((_a = keys(current)) === null || _a === void 0 ? void 0 : _a.includes('undefined')) {\r\n                (_b = keys(current)) === null || _b === void 0 ? void 0 : _b.forEach(function (ki) {\r\n                    result.push(current[ki]);\r\n                });\r\n            }\r\n            else {\r\n                result = result.concat(current);\r\n            }\r\n        });\r\n    }\r\n    else {\r\n        result = result.concat(data);\r\n    }\r\n    return result;\r\n};\r\nexport var isEveryUndefined = function (data) {\r\n    return data === null || data === void 0 ? void 0 : data.every(function (item) { return isUndefined(item); });\r\n};\r\nexport var getFieldKeysByDimensionValues = function (dimensionValues, dimensions) {\r\n    var result = [];\r\n    dimensionValues === null || dimensionValues === void 0 ? void 0 : dimensionValues.forEach(function (item, index) {\r\n        if (item === undefined) {\r\n            if (dimensions[index]) {\r\n                result.push(dimensions[index]);\r\n            }\r\n        }\r\n    });\r\n    return result;\r\n};\r\n/**\r\n * arr1包含arr2，将arr2排到最后\r\n *\r\n */\r\nexport var sortByItems = function (arr1, arr2) {\r\n    var _a;\r\n    return (_a = arr1 === null || arr1 === void 0 ? void 0 : arr1.filter(function (item) { return !(arr2 === null || arr2 === void 0 ? void 0 : arr2.includes(item)); })) === null || _a === void 0 ? void 0 : _a.concat(arr2);\r\n};\r\n/**\r\n * 判断是普通单元格数据还是总计或小计\r\n * @param ids\r\n * @param data\r\n * @returns\r\n */\r\nexport var isTotalData = function (ids, data) {\r\n    return !every(ids, function (id) { return data[id]; });\r\n};\r\n/**\r\n * split total data from origin list data.\r\n */\r\nexport function splitTotal(rawData, fields) {\r\n    var rows = fields.rows, columns = fields.columns;\r\n    return reduce(rawData, function (result, data) {\r\n        if (isTotalData([].concat(rows).concat(columns), data)) {\r\n            result.push(data);\r\n        }\r\n        return result;\r\n    }, []);\r\n}\r\nexport function getAggregationAndCalcFuncByQuery(totalsStatus, totalsOptions) {\r\n    var isRowTotal = totalsStatus.isRowTotal, isRowSubTotal = totalsStatus.isRowSubTotal, isColTotal = totalsStatus.isColTotal, isColSubTotal = totalsStatus.isColSubTotal;\r\n    var _a = totalsOptions || {}, row = _a.row, col = _a.col;\r\n    var _b = row || {}, _c = _b.calcTotals, rowCalcTotals = _c === void 0 ? {} : _c, _d = _b.calcSubTotals, rowCalcSubTotals = _d === void 0 ? {} : _d;\r\n    var _e = col || {}, _f = _e.calcTotals, colCalcTotals = _f === void 0 ? {} : _f, _g = _e.calcSubTotals, colCalcSubTotals = _g === void 0 ? {} : _g;\r\n    var getCalcTotals = function (dimensionTotals, totalType) {\r\n        if ((dimensionTotals.aggregation || dimensionTotals.calcFunc) &&\r\n            totalType) {\r\n            return {\r\n                aggregation: dimensionTotals.aggregation,\r\n                calcFunc: dimensionTotals.calcFunc,\r\n            };\r\n        }\r\n    };\r\n    // 优先级: 列总计/小计 > 行总计/小计\r\n    return (getCalcTotals(colCalcTotals, isColTotal) ||\r\n        getCalcTotals(colCalcSubTotals, isColSubTotal) ||\r\n        getCalcTotals(rowCalcTotals, isRowTotal) ||\r\n        getCalcTotals(rowCalcSubTotals, isRowSubTotal));\r\n}\r\n//# sourceMappingURL=data-set-operate.js.map","references":["F:/Ismart/S2-master/node_modules/@types/lodash/index.d.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/s2DataConfig.ts","F:/Ismart/S2-master/packages/s2-core/src/common/interface/index.ts"],"map":"{\"version\":3,\"file\":\"data-set-operate.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/utils/data-set-operate.ts\"],\"names\":[],\"mappings\":\"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\"}"}
